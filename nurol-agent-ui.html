<html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&amp;display=swap" rel="stylesheet"><script src="https://cdn.tailwindcss.com"></script><script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script><script src="https://d3js.org/d3.v7.min.js"></script><style>
body { font-family: 'Inter', sans-serif; }
</style><script>
function debounce(func, wait) {
let timeout;
return function executedFunction(...args) {
const later = () => {
clearTimeout(timeout);
func(...args);
};
clearTimeout(timeout);
timeout = setTimeout(later, wait);
};
}
const updateDom = debounce((html) => {
try {
if (!document.body) return;
const parser = new DOMParser();
const newDoc = parser.parseFromString(html, 'text/html');
// Preserve essential scripts and stylesheets when updating head
const currentHead = document.head;
const newHead = newDoc.head;
// Collect essential elements to preserve (CDNs, fonts, initial setup scripts)
const essentialElements = Array.from(currentHead.children).filter(el => {
// Preserve Tailwind CDN script
if (el.tagName === 'SCRIPT' && el.getAttribute('src')?.includes('tailwindcss.com')) {
return true;
}
// Preserve Lucide icons script
if (el.tagName === 'SCRIPT' && el.getAttribute('src')?.includes('lucide')) {
return true;
}
// Preserve the initial message listener script (this script)
if (el.tagName === 'SCRIPT' && !el.hasAttribute('src') &&
el.textContent?.includes('updateDom')) {
return true;
}
// Preserve Google Fonts preconnect and font links
if (el.tagName === 'LINK' && (
el.getAttribute('href')?.includes('fonts.googleapis.com') ||
el.getAttribute('href')?.includes('fonts.gstatic.com')
)) {
return true;
}
// Preserve viewport and charset meta tags
if (el.tagName === 'META' &&
(el.getAttribute('name') === 'viewport' || el.getAttribute('charset'))) {
return true;
}
// Preserve essential styles (like Inter font family)
if (el.tagName === 'STYLE' && el.textContent?.includes('Inter')) {
return true;
}
return false;
});
// Update head content while preserving essential elements
currentHead.innerHTML = '';
// Re-add essential elements first
essentialElements.forEach(el => {
currentHead.appendChild(el);
});
// Add new head content from the incoming HTML
Array.from(newHead.children).forEach(el => {
// Skip if we already have this essential element
const isEssential = (el.tagName === 'SCRIPT' && (el.getAttribute('src')?.includes('tailwindcss.com') || el.getAttribute('src')?.includes('lucide'))) ||
(el.tagName === 'LINK' && (el.getAttribute('href')?.includes('fonts.googleapis.com') || el.getAttribute('href')?.includes('fonts.gstatic.com'))) ||
(el.tagName === 'META' && (el.getAttribute('name') === 'viewport' || el.getAttribute('charset'))) ||
(el.tagName === 'STYLE' && el.textContent?.includes('Inter'));
if (!isEssential) {
currentHead.appendChild(el.cloneNode(true));
}
});
// Update body attributes (classes, styles, etc.)
const newBody = newDoc.body;
const currentBody = document.body;
// Copy all attributes from new body to current body
for (const attr of newBody.attributes) {
currentBody.setAttribute(attr.name, attr.value);
}
// Update body content
document.body.innerHTML = newDoc.body.innerHTML;
// Re-execute scripts in body to ensure they work properly
const scripts = Array.from(document.body.querySelectorAll('script'));
for (const oldScript of scripts) {
const newScript = document.createElement('script');
if (oldScript.src) {
newScript.src = oldScript.src;
} else {
newScript.textContent = oldScript.textContent;
}
if (oldScript.type) {
newScript.type = oldScript.type;
}
oldScript.parentNode.replaceChild(newScript, oldScript);
}
// Force Tailwind to reprocess the new content
// Try multiple methods to trigger Tailwind reprocessing
setTimeout(() => {
// Method 1: Use Tailwind's process function if available
if (window.tailwind && typeof window.tailwind.process === 'function') {
window.tailwind.process();
}
// Method 2: Trigger a style recalculation by temporarily changing a class
const tempElement = document.createElement('div');
tempElement.className = 'tailwind-trigger';
document.body.appendChild(tempElement);
setTimeout(() => {
document.body.removeChild(tempElement);
}, 10);
// Method 3: If Tailwind has a global config, reinitialize it
if (window.tailwind && typeof window.tailwind.default === 'function') {
window.tailwind.default();
}
}, 50);
} catch (e) {
console.error('Error updating preview:', e);
}
}, 200);
window.addEventListener('message', (event) => {
if (event.source !== window.parent) return;
const { type, html } = event.data;
if (type === 'update-html') {
updateDom(html);
}
});
</script><title>TradeAI | Akıllı Portföy Yönetimi &amp; BIST Trade Agent</title><meta name="disabled-font-classes" content="font-roboto,font-montserrat,font-poppins,font-playfair,font-instrument-serif,font-merriweather,font-bricolage,font-manrope,font-space-grotesk,font-work-sans,font-pt-serif,font-geist-mono,font-space-mono,font-quicksand,font-nunito,font-newsreader,font-oswald,font-dm-sans,font-cormorant,font-geist,font-jakarta">


<style id="cms-loading-styles">
@keyframes cms-shimmer {
0% { background-position: -200% 0; }
100% { background-position: 200% 0; }
}
.cms-loading {
position: relative;
color: transparent !important;
/* Override any background-image (inline styles, Tailwind bg-[url(...)]) */
background-image: none !important;
background-color: transparent !important;
background: linear-gradient(90deg,
rgba(128, 128, 128, 0.1) 25%,
rgba(128, 128, 128, 0.2) 50%,
rgba(128, 128, 128, 0.1) 75%
) !important;
background-size: 200% 100% !important;
animation: cms-shimmer 1.5s infinite !important;
border-radius: 12px;
min-height: 1em;
min-width: 3em;
overflow: hidden;
}
.cms-loading * {
visibility: hidden !important;
}
.cms-loading img {
opacity: 0 !important;
}
@keyframes toast-in { from { transform: translateX(120%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
@keyframes toast-out { from { transform: translateX(0); opacity: 1; } to { transform: translateX(120%); opacity: 0; } }
@keyframes success-check { 0% { stroke-dashoffset: 50; } 100% { stroke-dashoffset: 0; } }
@keyframes success-circle { 0% { stroke-dashoffset: 166; } 100% { stroke-dashoffset: 0; } }
@keyframes pulse-ring { 0% { transform: scale(0.8); opacity: 1; } 100% { transform: scale(1.4); opacity: 0; } }
@keyframes price-flash { 0% { background-color: var(--flash-color); } 100% { background-color: transparent; } }
@keyframes fade-in { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.toast-enter { animation: toast-in 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
.toast-exit { animation: toast-out 0.3s ease-in forwards; }
.price-flash-up { --flash-color: rgba(16,185,129,0.15); animation: price-flash 0.8s ease-out; }
.price-flash-down { --flash-color: rgba(239,68,68,0.15); animation: price-flash 0.8s ease-out; }
.page-fade-in { animation: fade-in 0.3s ease-out forwards; }
#toast-container { position: fixed; top: 80px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; }
#toast-container > div { pointer-events: auto; }
</style>


        
        
        
        <link id="all-fonts-link-font-google-sans-flex" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Google+Sans+Flex:wght@400;500;600;700&amp;display=swap"><style id="all-fonts-style-font-google-sans-flex">.font-google-sans-flex { font-family: 'Google Sans Flex', sans-serif !important; }</style></head>
      <body class="antialiased text-neutral-900 bg-neutral-100 min-h-screen">

    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-white border-b border-neutral-200">
        <div class="flex max-w-7xl mr-auto ml-auto pt-2 pr-6 pb-2 pl-6 items-center justify-between">
            <div class="flex items-center gap-8">
                <a href="#" class="flex items-center gap-3">
                    <img src="logolar/nurolagent-logo.png" alt="Nurol Agent Logo" class="h-14 w-auto">
                    <span class="text-xl font-semibold tracking-tight font-sans">Nurol Agent</span>
                </a>
                <div class="hidden md:flex items-center gap-1">
                    <a href="#" data-page="dashboard" class="nav-link text-sm text-neutral-900 px-3 py-1.5 bg-neutral-100 rounded-lg font-medium font-sans">Dashboard</a>
                    <a href="#" data-page="portfolio" class="nav-link hover:bg-neutral-50 transition-colors text-sm text-neutral-500 font-sans rounded-lg pt-1.5 pr-3 pb-1.5 pl-3">Portföy</a>
                    <a href="#" data-page="funds" class="nav-link text-sm text-neutral-500 px-3 py-1.5 hover:bg-neutral-50 rounded-lg transition-colors font-sans">Fonlar</a>
                    <a href="#" data-page="history" class="nav-link text-sm text-neutral-500 px-3 py-1.5 hover:bg-neutral-50 rounded-lg transition-colors font-sans">Geçmiş</a>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div class="hidden sm:flex items-center gap-2 px-3 py-1.5 bg-emerald-50 rounded-full">
                    <div class="w-2 h-2 bg-emerald-500 rounded-full"></div>
                    <span class="text-xs text-emerald-700 font-medium font-sans">3 Agent Aktif</span>
                </div>
                <button id="notification-bell" class="p-2 hover:bg-neutral-100 rounded-lg transition-colors relative">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-lucide="bell" aria-hidden="true" class="lucide lucide-bell w-[20px] h-[20px]" data-icon-replaced="true" style="color: rgb(82, 82, 82); width: 20px; height: 20px"><path d="M10.268 21a2 2 0 0 0 3.464 0"></path><path d="M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326" class=""></path></svg>
                    <div id="notification-badge" class="absolute -top-0.5 -right-0.5 min-w-[18px] h-[18px] bg-red-500 rounded-full flex items-center justify-center"><span class="text-white text-[10px] font-bold leading-none">3</span></div>
                </button>
                <div class="relative">
                    <div id="user-avatar" class="w-8 h-8 rounded-full bg-neutral-900 flex items-center justify-center text-white text-xs font-medium cursor-pointer font-sans hover:ring-2 hover:ring-neutral-300 transition-all">
                        AK
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-20 pb-12">
        <div class="max-w-7xl mr-auto ml-auto pr-6 pl-6">

            <!-- Dashboard Page -->
            <div id="page-dashboard" class="page-content">
            <!-- Welcome Header -->
            <div class="mb-8">
                <h1 class="text-2xl font-light text-neutral-900 tracking-tight font-google-sans-flex">Günaydın, Ahmet</h1>
                <p class="text-base text-neutral-500 mt-1 font-sans">Günlük portföy metrikleriniz hazır.</p>
            </div>

            <!-- Top Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                
                <!-- Total Portfolio Card -->
                <div class="bg-white rounded-2xl p-6 border border-neutral-200 flex items-center justify-between">
                    <div>
                        <p class="text-xs text-neutral-500 uppercase tracking-wider mb-1 font-sans">Toplam Portföy</p>
                        <p class="text-3xl tracking-tight font-google-sans-flex font-light">₺2.84M</p>
                        <div class="flex items-center gap-1 mt-2">
                            <span class="text-sm text-emerald-600 font-medium font-sans">+12.4%</span>
                            <span class="text-xs text-neutral-400 font-sans">bu ay</span>
                        </div>
                    </div>
                    <div class="w-20 h-20 rounded-xl overflow-hidden flex items-center justify-center">
                        <img src="logolar/nurolagent-logo (2).png" alt="Nurol Agent" class="w-full h-full object-cover">
                    </div>
                </div>

                <!-- Daily Performance Card -->
                <div class="bg-white rounded-2xl p-6 border border-neutral-200 flex items-center justify-between">
                    <div class="">
                        <p class="text-xs text-neutral-500 uppercase tracking-wider mb-1 font-sans">Günlük Performans</p>
                        <div class="flex items-baseline gap-2">
                            <p id="daily-performance" class="text-3xl tracking-tight font-google-sans-flex font-light">+₺48.7K</p>
                        </div>
                        <div class="flex items-center gap-1 mt-2">
                            <span class="text-sm text-emerald-600 font-medium font-sans">↑12.4%</span>
                            <span id="daily-trades-count" class="text-xs text-neutral-400 font-sans">24 işlem</span>
                        </div>
                    </div>
                    <div class="flex flex-col items-end">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-lucide="sparkles" aria-hidden="true" class="lucide lucide-sparkles w-6 h-6 text-neutral-400 mb-2"><path d="M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z"></path><path d="M20 2v4"></path><path d="M22 4h-4"></path><circle cx="4" cy="20" r="2"></circle></svg>
                    </div>
                </div>

                <!-- Forecast Card -->
                <div class="bg-white rounded-2xl p-6 border border-neutral-200 flex items-center gap-4">
                    <div class="w-20 h-20 rounded-xl overflow-hidden flex items-center justify-center">
                        <img src="logolar/nurolagent-logo (2).png" alt="Nurol Agent" class="w-full h-full object-cover">
                    </div>
                    <div class="">
                        <span class="inline-flex px-2 py-0.5 bg-[#E8FF5A] text-neutral-900 text-xs font-medium rounded-full mb-2 font-sans">Tahmin</span>
                        <p class="text-sm font-medium text-neutral-900 font-sans">2025 hedefine %16 uzaklıktasınız</p>
                    </div>
                </div>
            </div>

            <!-- Main Chart Section -->
            <!-- Portföy Performans Trendi - Professional Chart Component -->
            <div class="bg-white rounded-2xl mb-6 overflow-hidden" style="border: 2px solid #000000;">
                <!-- Chart Header -->
                <div class="px-6 py-5" style="border-bottom: 2px solid #000000;">
                    <div class="flex items-start justify-between">
                        <!-- Left: Title & Value -->
                        <div class="flex items-center gap-5">
                            <div class="w-14 h-14 rounded-2xl flex items-center justify-center overflow-hidden" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <img src="logolar/nurolagent-logo (2).png" alt="Nurol Agent" class="w-10 h-10 object-contain">
                            </div>
                            <div>
                                <h2 class="text-lg font-semibold text-neutral-900 font-sans tracking-tight">Portföy Performans Trendi</h2>
                                <div class="flex items-center gap-4 mt-2">
                                    <span id="chart-current-value" class="text-3xl font-bold text-neutral-900 font-google-sans-flex tracking-tight">₺2.84M</span>
                                    <div class="flex items-center gap-2">
                                        <span id="chart-change-badge" class="px-3 py-1 text-sm font-bold rounded-lg" style="background-color: #E8FF5A; border: 2px solid #000000;">+12.4%</span>
                                        <span id="chart-change-amount" class="text-sm font-medium text-neutral-500 font-sans">+₺312K</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right: Period Buttons & Actions -->
                        <div class="flex items-center gap-3">
                            <div class="flex items-center rounded-xl overflow-hidden bg-neutral-100" style="border: 2px solid #000000;">
                                <button data-period="1G" class="chart-period-btn px-4 py-2.5 text-xs font-semibold text-neutral-500 hover:bg-neutral-200 transition-all font-sans">1G</button>
                                <button data-period="1H" class="chart-period-btn px-4 py-2.5 text-xs font-semibold text-neutral-900 font-sans" style="background-color: #E8FF5A;">1H</button>
                                <button data-period="1A" class="chart-period-btn px-4 py-2.5 text-xs font-semibold text-neutral-500 hover:bg-neutral-200 transition-all font-sans">1A</button>
                                <button data-period="6A" class="chart-period-btn px-4 py-2.5 text-xs font-semibold text-neutral-500 hover:bg-neutral-200 transition-all font-sans">6A</button>
                                <button data-period="1Y" class="chart-period-btn px-4 py-2.5 text-xs font-semibold text-neutral-500 hover:bg-neutral-200 transition-all font-sans">1Y</button>
                                <button data-period="MAX" class="chart-period-btn px-4 py-2.5 text-xs font-semibold text-neutral-500 hover:bg-neutral-200 transition-all font-sans">MAX</button>
                            </div>
                            <button id="chart-fullscreen-btn" class="p-2.5 rounded-xl bg-neutral-900 text-white hover:bg-neutral-800 transition-colors" style="border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Chart Stats Row -->
                <div class="grid grid-cols-5 gap-4 px-6 py-4" style="background-color: #FAFAFA; border-bottom: 2px solid #000000;">
                    <div class="flex flex-col items-center p-3 rounded-xl bg-white" style="border: 2px solid #000000;">
                        <span class="text-xs text-neutral-500 font-sans font-medium mb-1">Yüksek</span>
                        <span id="chart-high" class="text-sm font-bold text-neutral-900 font-sans">₺2.92M</span>
                        <div class="w-full h-1 mt-2 rounded-full" style="background-color: #E8FF5A;"></div>
                    </div>
                    <div class="flex flex-col items-center p-3 rounded-xl bg-white" style="border: 2px solid #000000;">
                        <span class="text-xs text-neutral-500 font-sans font-medium mb-1">Düşük</span>
                        <span id="chart-low" class="text-sm font-bold text-neutral-900 font-sans">₺2.51M</span>
                        <div class="w-full h-1 mt-2 rounded-full bg-neutral-300"></div>
                    </div>
                    <div class="flex flex-col items-center p-3 rounded-xl bg-white" style="border: 2px solid #000000;">
                        <span class="text-xs text-neutral-500 font-sans font-medium mb-1">Ortalama</span>
                        <span id="chart-avg" class="text-sm font-bold text-neutral-900 font-sans">₺2.72M</span>
                        <div class="w-full h-1 mt-2 rounded-full bg-neutral-400"></div>
                    </div>
                    <div class="flex flex-col items-center p-3 rounded-xl bg-white" style="border: 2px solid #000000;">
                        <span class="text-xs text-neutral-500 font-sans font-medium mb-1">Hacim</span>
                        <span id="chart-volume" class="text-sm font-bold text-neutral-900 font-sans">₺847K</span>
                        <div class="w-full h-1 mt-2 rounded-full bg-neutral-200"></div>
                    </div>
                    <div class="flex flex-col items-center p-3 rounded-xl" style="background-color: #E8FF5A; border: 2px solid #000000;">
                        <span class="text-xs text-neutral-700 font-sans font-medium mb-1">Durum</span>
                        <div class="flex items-center gap-2">
                            <div class="w-2.5 h-2.5 bg-neutral-900 rounded-full animate-pulse"></div>
                            <span class="text-sm font-bold text-neutral-900 font-sans">Canlı</span>
                        </div>
                        <div class="w-full h-1 mt-2 rounded-full bg-neutral-900"></div>
                    </div>
                </div>

                <!-- Interactive Chart Canvas -->
                <div class="relative" style="height: 380px; background: linear-gradient(180deg, #FFFFFF 0%, #FAFAFA 100%);">
                    <!-- Tooltip -->
                    <div id="chart-tooltip" class="absolute hidden z-30 px-5 py-4 rounded-2xl shadow-2xl pointer-events-none" style="background-color: #171717; border: 3px solid #E8FF5A; min-width: 160px;">
                        <div class="flex items-center gap-2 mb-2">
                            <div class="w-2 h-2 rounded-full" style="background-color: #E8FF5A;"></div>
                            <p id="tooltip-date" class="text-sm text-neutral-300 font-sans font-medium"></p>
                        </div>
                        <p id="tooltip-value" class="text-2xl font-bold text-white font-sans tracking-tight"></p>
                        <div class="flex items-center gap-2 mt-2">
                            <p id="tooltip-change" class="text-sm font-bold font-sans"></p>
                            <span class="text-xs text-neutral-500 font-sans">başlangıçtan</span>
                        </div>
                    </div>

                    <!-- Crosshair -->
                    <div id="chart-crosshair-v" class="absolute top-0 bottom-0 w-0.5 hidden pointer-events-none" style="z-index: 10; background-color: #171717;"></div>
                    <div id="chart-crosshair-h" class="absolute left-0 right-0 h-0.5 hidden pointer-events-none" style="z-index: 10; background-color: #171717;"></div>

                    <!-- Hover Point Indicator -->
                    <div id="chart-hover-point" class="absolute hidden pointer-events-none w-4 h-4 rounded-full" style="z-index: 15; background-color: #E8FF5A; border: 3px solid #171717; transform: translate(-50%, -50%);"></div>

                    <!-- Canvas -->
                    <canvas id="portfolio-chart" class="w-full h-full cursor-crosshair"></canvas>
                </div>

                <!-- Chart Footer -->
                <div class="flex items-center justify-between px-6 py-4" style="border-top: 2px solid #000000; background-color: #171717;">
                    <div class="flex items-center gap-4">
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-1 rounded-full" style="background-color: #E8FF5A;"></div>
                            <span class="text-xs text-neutral-400 font-sans">Portföy Değeri</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-1 rounded-full bg-neutral-600"></div>
                            <span class="text-xs text-neutral-400 font-sans">BIST 100 Benchmark</span>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <span class="text-xs text-neutral-500 font-sans">Son güncelleme:</span>
                        <span id="chart-last-update" class="text-xs font-medium text-white font-sans">Şimdi</span>
                    </div>
                </div>
            </div>

            <!-- Three Column Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 gap-x-6 gap-y-6">
                
                <!-- Left Column -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- AI Chat Interface -->
                    <div class="bg-white rounded-2xl overflow-hidden" style="height: 400px; border: 2px solid #000000;">
                        <div class="flex pt-4 pr-6 pb-4 pl-6 items-center justify-between" style="border-bottom: 2px solid #000000;">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot w-5 h-5 text-neutral-900"><path d="M12 8V4H8"></path><rect width="16" height="12" x="4" y="8" rx="2"></rect><path d="M2 14h2"> 14h2"&gt;</path><path d="M15 13v2"></path><path d="M9 13v2"></path></svg>
                                </div>
                                <div class="">
                                    <h3 class="text-sm font-medium text-neutral-900 font-sans">TradeAI Asistan</h3>
                                    <p class="text-xs text-neutral-500 font-sans">BIST Fon Yönetim Agentı</p>
                                </div>
                            </div>
                            <span class="px-2 py-1 text-neutral-900 text-xs font-medium rounded-full font-sans" style="background-color: #E8FF5A; border: 2px solid #000000;">Çevrimiçi</span>
                        </div>

                        <div id="chat-messages" class="flex-1 overflow-y-auto scrollbar-hide pt-6 pr-6 pb-6 pl-6 space-y-4" style="height: 260px">
                            <!-- AI Message -->
                            <div class="flex gap-3">
                                <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center flex-shrink-0" style="border: 2px solid #000000;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-bot w-4 h-4 text-white"><path d="M12 8V4H8"></path><rect width="16" height="12" x="4" y="8" rx="2"></rect><path d="M2 14h2"></path><path d="M20 14h2"></path><path d="M15 13v2"></path><path d="M9 13v2"></path></svg>
                                </div>
                                <div class="flex-1">
                                    <div class="bg-neutral-100 rounded-2xl rounded-tl-md p-4 max-w-md" style="border: 2px solid #000000;">
                                        <p class="text-sm text-neutral-700 font-sans">Portföyünüz bugün %1.7 artış gösterdi. TEFAS Teknoloji fonunuzda güçlü momentum var.</p>
                                    </div>
                                    <span class="text-xs text-neutral-400 mt-1 block font-sans">10:32</span>
                                </div>
                            </div>

                            <!-- Quick Actions -->
                            <div class="flex gap-3">
                                <div class="w-8 h-8 flex-shrink-0"></div>
                                <div class="flex flex-wrap gap-2">
                                    <button class="quick-action-btn px-3 py-1.5 bg-neutral-900 text-white text-xs font-medium rounded-full hover:bg-neutral-800 transition-colors font-sans" style="border: 2px solid #000000;">
                                        Analiz Detayı
                                    </button>
                                    <button class="quick-action-btn px-3 py-1.5 text-neutral-900 text-xs font-medium rounded-full hover:bg-neutral-200 transition-colors font-sans" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                        Risk Raporu
                                    </button>
                                    <button class="quick-action-btn px-3 py-1.5 bg-neutral-100 text-neutral-700 text-xs font-medium rounded-full hover:bg-neutral-200 transition-colors font-sans" style="border: 2px solid #000000;">
                                        Öneri Al
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="p-4" style="border-top: 2px solid #000000;">
                            <div class="flex items-center gap-3">
                                <div class="flex-1 relative">
                                    <input id="chat-input" type="text" placeholder="Mesajınızı yazın..." class="w-full px-4 py-3 bg-neutral-100 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-neutral-900/10 transition-all" style="border: 2px solid #000000;">
                                </div>
                                <button id="chat-send-btn" class="p-3 rounded-xl transition-colors hover:opacity-80" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-send w-4 h-4"><path d="M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"></path><path d="m21.854 2.147-10.94 10.939"></path></svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Transactions -->
                    <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                        <div class="px-6 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                            <h3 class="text-sm font-medium text-neutral-900 font-sans">Son İşlemler</h3>
                            <a href="#" class="text-xs text-neutral-500 hover:text-neutral-900 transition-colors font-sans" onclick="event.preventDefault(); NurolApp.navigateTo('history');">Tümünü Gör →</a>
                        </div>
                        <div id="transactions-list" class="divide-y divide-neutral-100">
                            <div class="px-6 py-4 flex items-center justify-between hover:bg-neutral-50 transition-colors">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-right w-4 h-4 text-neutral-900"><path d="M7 7h10v10"></path><path d="M7 17 17 7"></path></svg>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-neutral-900 font-sans">TEFAS Teknoloji</p>
                                        <p class="text-xs text-neutral-500 font-sans">Alım • Agent</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm font-medium text-emerald-600 font-sans">+₺25,000</p>
                                    <p class="text-xs text-neutral-400 font-sans">12:45</p>
                                </div>
                            </div>

                            <div class="px-6 py-4 flex items-center justify-between hover:bg-neutral-50 transition-colors">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center" style="border: 2px solid #000000;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-down-right w-4 h-4 text-red-500"><path d="m7 7 10 10"></path><path d="M17 7v10H7"></path></svg>
                                    </div>
                                    <div>
                                        <p class="text-sm font-medium text-neutral-900 font-sans">İş Bankası Hisse</p>
                                        <p class="text-xs text-neutral-500 font-sans">Satım • Manuel</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm font-medium text-red-500 font-sans">-₺12,500</p>
                                    <p class="text-xs text-neutral-400 font-sans">11:20</p>
                                </div>
                            </div>

                            <div class="px-6 py-4 flex items-center justify-between hover:bg-neutral-50 transition-colors">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-up-right w-4 h-4 text-neutral-900"><path d="M7 7h10v10"></path><path d="M7 17 17 7"></path></svg>
                                    </div>
                                    <div class="">
                                        <p class="text-sm font-medium text-neutral-900 font-sans">Yapı Kredi Altın</p>
                                        <p class="text-xs text-neutral-500 font-sans">Alım • Agent</p>
                                    </div>
                                </div>
                                <div class="text-right">
                                    <p class="text-sm font-medium text-emerald-600 font-sans">+₺50,000</p>
                                    <p class="text-xs text-neutral-400 font-sans">10:05</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Sidebar -->
                <div class="space-y-6">
                    
                    <!-- Active Agents -->
                    <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                        <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                            <h3 class="text-sm font-medium text-neutral-900 font-sans">Aktif Agentlar</h3>
                            <button id="manage-agents-btn" class="text-xs text-neutral-500 hover:text-neutral-900 font-sans" onclick="NurolApp.showToast('Agent yönetim paneli yakında aktif olacak', 'info')">Yönet</button>
                        </div>
                        <div id="agents-list" class="p-4 space-y-3">
                            <!-- Agent 1: Trend Takipçi -->
                            <div class="p-3 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center gap-2">
                                        <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center" style="border: 2px solid #000000;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trending-up w-4 h-4 text-white"><path d="M16 7h6v6"></path><path d="m22 7-8.5 8.5-5-5L2 17"></path></svg>
                                        </div>
                                        <div>
                                            <p class="text-xs font-medium text-neutral-900 font-sans">Trend Takipçi</p>
                                            <p class="text-xs text-neutral-500 font-sans">Momentum</p>
                                        </div>
                                    </div>
                                    <button data-agent-id="1" class="agent-toggle w-3 h-3 rounded-full cursor-pointer hover:scale-110 transition-transform" id="agent-1-status" style="background-color: #E8FF5A; border: 2px solid #000000;" title="Tıkla: Aç/Kapat"></button>
                                </div>
                                <div class="flex items-center justify-between text-xs">
                                    <span class="text-neutral-500 font-sans">8 işlem</span>
                                    <span class="text-emerald-600 font-medium font-sans">+₺12,450</span>
                                </div>
                            </div>

                            <!-- Agent 2: Risk Yöneticisi -->
                            <div class="p-3 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center gap-2">
                                        <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shield w-4 h-4 text-neutral-900"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path></svg>
                                        </div>
                                        <div>
                                            <p class="text-xs font-medium text-neutral-900 font-sans">Risk Yöneticisi</p>
                                            <p class="text-xs text-neutral-500 font-sans">Koruma</p>
                                        </div>
                                    </div>
                                    <button data-agent-id="2" class="agent-toggle w-3 h-3 rounded-full cursor-pointer hover:scale-110 transition-transform" id="agent-2-status" style="background-color: #E8FF5A; border: 2px solid #000000;" title="Tıkla: Aç/Kapat"></button>
                                </div>
                                <div class="flex items-center justify-between text-xs">
                                    <span class="text-neutral-500 font-sans">4 fon</span>
                                    <span class="text-blue-600 font-medium font-sans">Düşük risk</span>
                                </div>
                            </div>

                            <!-- Agent 3: Zamanlayıcı -->
                            <div class="p-3 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                                <div class="flex items-center justify-between mb-2">
                                    <div class="flex items-center gap-2">
                                        <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center" style="border: 2px solid #000000;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clock w-4 h-4 text-white"><path d="M12 6v6l4 2"></path><circle cx="12" cy="12" r="10"></circle></svg>
                                        </div>
                                        <div>
                                            <p class="text-xs font-medium text-neutral-900 font-sans">Zamanlayıcı</p>
                                            <p class="text-xs text-neutral-500 font-sans">DCA</p>
                                        </div>
                                    </div>
                                    <button data-agent-id="3" class="agent-toggle w-3 h-3 rounded-full cursor-pointer hover:scale-110 transition-transform" id="agent-3-status" style="background-color: #E8FF5A; border: 2px solid #000000;" title="Tıkla: Aç/Kapat"></button>
                                </div>
                                <div class="flex items-center justify-between text-xs">
                                    <span class="text-neutral-500 font-sans">Sonraki: 14:00</span>
                                    <span class="text-purple-600 font-medium font-sans">₺5K/gün</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Portfolio Distribution - D3.js Treemap -->
                    <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                        <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                            <h3 class="text-sm font-medium text-neutral-900 font-sans">Varlık Dağılımı</h3>
                            <span class="text-xs text-neutral-500 font-sans">Treemap</span>
                        </div>
                        <div class="p-3">
                            <div id="treemap-chart" style="width: 100%; min-height: 260px;"></div>
                        </div>
                    </div>

                    <!-- Market Status -->
                    <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                        <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                            <h3 class="text-sm font-medium text-neutral-900 font-sans">Piyasa</h3>
                            <div id="market-status-badge" class="flex items-center gap-1 px-2 py-1 rounded-full" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <div class="w-2 h-2 bg-neutral-900 rounded-full animate-pulse"></div>
                                <span class="text-xs text-neutral-900 font-medium font-sans">Açık</span>
                            </div>
                        </div>
                        <div class="p-4 space-y-3">
                            <div id="market-bist100" class="flex items-center justify-between p-3 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                                <div>
                                    <p class="text-xs text-neutral-500 font-sans">BIST 100</p>
                                    <p class="value text-sm font-medium text-neutral-900 font-sans">9,847.32</p>
                                </div>
                                <span class="change text-xs text-neutral-900 font-medium px-2 py-1 rounded-full font-sans" style="background-color: #E8FF5A; border: 2px solid #000000;">+1.24%</span>
                            </div>

                            <div id="market-usdtry" class="flex items-center justify-between p-3 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                                <div>
                                    <p class="text-xs text-neutral-500 font-sans">USD/TRY</p>
                                    <p class="value text-sm font-medium text-neutral-900 font-sans">32.45</p>
                                </div>
                                <span class="change text-xs text-red-500 font-medium bg-red-50 px-2 py-1 rounded-full font-sans" style="border: 2px solid #000000;">-0.32%</span>
                            </div>

                            <div id="market-gold" class="flex items-center justify-between p-3 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                                <div>
                                    <p class="text-xs text-neutral-500 font-sans">Gram Altın</p>
                                    <p class="value text-sm font-medium text-neutral-900 font-sans">₺2,485</p>
                                </div>
                                <span class="change text-xs text-neutral-900 font-medium px-2 py-1 rounded-full font-sans" style="background-color: #E8FF5A; border: 2px solid #000000;">+0.87%</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- New Components Section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">

                <!-- Watchlist / İzleme Listesi -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <h3 class="text-sm font-medium text-neutral-900 font-sans">İzleme Listesi</h3>
                        <button id="add-watchlist-btn" class="text-xs px-2 py-1 rounded-full font-sans hover:opacity-80 transition-opacity" style="background-color: #E8FF5A; border: 2px solid #000000;">+ Ekle</button>
                    </div>
                    <div id="watchlist-container" class="p-4 space-y-2 max-h-64 overflow-y-auto">
                        <div class="watchlist-item flex items-center justify-between p-3 bg-neutral-50 rounded-xl hover:bg-neutral-100 transition-colors cursor-pointer" style="border: 2px solid #000000;" data-symbol="THYAO">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center" style="border: 2px solid #000000;">
                                    <span class="text-white text-xs font-bold">TH</span>
                                </div>
                                <div>
                                    <p class="text-xs font-medium text-neutral-900 font-sans">THYAO</p>
                                    <p class="text-xs text-neutral-500 font-sans">Türk Hava Yolları</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-medium text-neutral-900 font-sans">₺287.40</p>
                                <p class="text-xs text-emerald-600 font-medium font-sans">+2.34%</p>
                            </div>
                        </div>
                        <div class="watchlist-item flex items-center justify-between p-3 bg-neutral-50 rounded-xl hover:bg-neutral-100 transition-colors cursor-pointer" style="border: 2px solid #000000;" data-symbol="GARAN">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                    <span class="text-neutral-900 text-xs font-bold">GA</span>
                                </div>
                                <div>
                                    <p class="text-xs font-medium text-neutral-900 font-sans">GARAN</p>
                                    <p class="text-xs text-neutral-500 font-sans">Garanti BBVA</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-medium text-neutral-900 font-sans">₺98.75</p>
                                <p class="text-xs text-red-500 font-medium font-sans">-0.82%</p>
                            </div>
                        </div>
                        <div class="watchlist-item flex items-center justify-between p-3 bg-neutral-50 rounded-xl hover:bg-neutral-100 transition-colors cursor-pointer" style="border: 2px solid #000000;" data-symbol="ASELS">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center" style="border: 2px solid #000000;">
                                    <span class="text-white text-xs font-bold">AS</span>
                                </div>
                                <div>
                                    <p class="text-xs font-medium text-neutral-900 font-sans">ASELS</p>
                                    <p class="text-xs text-neutral-500 font-sans">Aselsan</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-medium text-neutral-900 font-sans">₺54.20</p>
                                <p class="text-xs text-emerald-600 font-medium font-sans">+1.15%</p>
                            </div>
                        </div>
                        <div class="watchlist-item flex items-center justify-between p-3 bg-neutral-50 rounded-xl hover:bg-neutral-100 transition-colors cursor-pointer" style="border: 2px solid #000000;" data-symbol="SISE">
                            <div class="flex items-center gap-3">
                                <div class="w-8 h-8 rounded-lg flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                    <span class="text-neutral-900 text-xs font-bold">SI</span>
                                </div>
                                <div>
                                    <p class="text-xs font-medium text-neutral-900 font-sans">SISE</p>
                                    <p class="text-xs text-neutral-500 font-sans">Şişecam</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-medium text-neutral-900 font-sans">₺45.80</p>
                                <p class="text-xs text-emerald-600 font-medium font-sans">+0.44%</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Trade Önerileri - Axiom Style -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <!-- Header with tabs -->
                    <div class="px-5 py-3" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center gap-2">
                                <div class="w-7 h-7 rounded-lg flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
                                </div>
                                <h3 class="text-sm font-semibold text-neutral-900 font-sans">AI Sinyalleri</h3>
                            </div>
                            <div class="flex items-center gap-1.5">
                                <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></div>
                                <span class="text-xs text-neutral-500 font-sans">Canlı</span>
                            </div>
                        </div>
                        <div class="flex gap-1 rounded-xl p-1 bg-neutral-100" style="border: 2px solid #000000;">
                            <button id="signal-tab-all" class="signal-tab flex-1 text-xs font-medium py-1.5 rounded-lg transition-colors font-sans" style="background-color: #E8FF5A;" data-filter="all">Tümü</button>
                            <button id="signal-tab-buy" class="signal-tab flex-1 text-xs font-medium py-1.5 rounded-lg text-neutral-500 transition-colors font-sans" data-filter="buy">Alım</button>
                            <button id="signal-tab-sell" class="signal-tab flex-1 text-xs font-medium py-1.5 rounded-lg text-neutral-500 transition-colors font-sans" data-filter="sell">Satım</button>
                        </div>
                    </div>

                    <!-- Signal Cards -->
                    <div id="ai-recommendations" class="p-3 space-y-2 max-h-72 overflow-y-auto">
                        <!-- Signal 1 - Strong Buy -->
                        <div class="ai-recommendation signal-card" data-type="buy" style="border: 2px solid #000000; border-radius: 12px; overflow: hidden;">
                            <div class="flex items-stretch">
                                <div class="w-1.5 bg-emerald-500"></div>
                                <div class="flex-1 p-3">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-sm font-bold text-neutral-900 font-sans">THYAO</span>
                                            <span class="text-xs px-1.5 py-0.5 font-medium rounded bg-emerald-100 text-emerald-700 font-sans">Güçlü Alım</span>
                                        </div>
                                        <span class="text-xs text-neutral-400 font-sans">2dk önce</span>
                                    </div>
                                    <div class="flex items-center gap-4 mb-2">
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Fiyat</span>
                                            <p class="text-sm font-semibold text-neutral-900 font-sans">₺287.40</p>
                                        </div>
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Hedef</span>
                                            <p class="text-sm font-semibold text-emerald-600 font-sans">₺312.00</p>
                                        </div>
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Potansiyel</span>
                                            <p class="text-sm font-semibold text-emerald-600 font-sans">+8.5%</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="text-xs text-neutral-500 font-sans">Güven:</span>
                                        <div class="flex-1 h-1.5 bg-neutral-200 rounded-full overflow-hidden">
                                            <div class="h-full rounded-full" style="width: 87%; background-color: #E8FF5A;"></div>
                                        </div>
                                        <span class="text-xs font-semibold text-neutral-900 font-sans">87%</span>
                                    </div>
                                    <button class="trade-btn w-full py-2 text-xs font-semibold rounded-lg transition-all hover:scale-[1.02]" style="background-color: #E8FF5A; border: 2px solid #000000;" data-action="buy" data-symbol="THYAO">
                                        Al →
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Signal 2 - Sell -->
                        <div class="ai-recommendation signal-card" data-type="sell" style="border: 2px solid #000000; border-radius: 12px; overflow: hidden;">
                            <div class="flex items-stretch">
                                <div class="w-1.5 bg-red-500"></div>
                                <div class="flex-1 p-3">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-sm font-bold text-neutral-900 font-sans">EREGL</span>
                                            <span class="text-xs px-1.5 py-0.5 font-medium rounded bg-red-100 text-red-700 font-sans">Satım</span>
                                        </div>
                                        <span class="text-xs text-neutral-400 font-sans">8dk önce</span>
                                    </div>
                                    <div class="flex items-center gap-4 mb-2">
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Fiyat</span>
                                            <p class="text-sm font-semibold text-neutral-900 font-sans">₺54.20</p>
                                        </div>
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Stop</span>
                                            <p class="text-sm font-semibold text-red-500 font-sans">₺48.50</p>
                                        </div>
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Risk</span>
                                            <p class="text-sm font-semibold text-red-500 font-sans">-10.5%</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="text-xs text-neutral-500 font-sans">Güven:</span>
                                        <div class="flex-1 h-1.5 bg-neutral-200 rounded-full overflow-hidden">
                                            <div class="h-full bg-red-400 rounded-full" style="width: 72%;"></div>
                                        </div>
                                        <span class="text-xs font-semibold text-neutral-900 font-sans">72%</span>
                                    </div>
                                    <button class="trade-btn w-full py-2 text-xs font-semibold rounded-lg transition-all hover:scale-[1.02] bg-neutral-900 text-white" style="border: 2px solid #000000;" data-action="sell" data-symbol="EREGL">
                                        Sat →
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Signal 3 - Buy -->
                        <div class="ai-recommendation signal-card" data-type="buy" style="border: 2px solid #000000; border-radius: 12px; overflow: hidden;">
                            <div class="flex items-stretch">
                                <div class="w-1.5 bg-emerald-500"></div>
                                <div class="flex-1 p-3">
                                    <div class="flex items-center justify-between mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-sm font-bold text-neutral-900 font-sans">GARAN</span>
                                            <span class="text-xs px-1.5 py-0.5 font-medium rounded bg-emerald-100 text-emerald-700 font-sans">Alım</span>
                                        </div>
                                        <span class="text-xs text-neutral-400 font-sans">15dk önce</span>
                                    </div>
                                    <div class="flex items-center gap-4 mb-2">
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Fiyat</span>
                                            <p class="text-sm font-semibold text-neutral-900 font-sans">₺98.75</p>
                                        </div>
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Hedef</span>
                                            <p class="text-sm font-semibold text-emerald-600 font-sans">₺108.00</p>
                                        </div>
                                        <div>
                                            <span class="text-xs text-neutral-500 font-sans">Potansiyel</span>
                                            <p class="text-sm font-semibold text-emerald-600 font-sans">+9.4%</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="text-xs text-neutral-500 font-sans">Güven:</span>
                                        <div class="flex-1 h-1.5 bg-neutral-200 rounded-full overflow-hidden">
                                            <div class="h-full rounded-full" style="width: 79%; background-color: #E8FF5A;"></div>
                                        </div>
                                        <span class="text-xs font-semibold text-neutral-900 font-sans">79%</span>
                                    </div>
                                    <button class="trade-btn w-full py-2 text-xs font-semibold rounded-lg transition-all hover:scale-[1.02]" style="background-color: #E8FF5A; border: 2px solid #000000;" data-action="buy" data-symbol="GARAN">
                                        Al →
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Top Gainers / Losers -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center gap-2">
                            <button id="gainers-tab" class="tab-btn text-xs font-medium px-3 py-1 rounded-lg bg-neutral-900 text-white" data-tab="gainers">Yükselenler</button>
                            <button id="losers-tab" class="tab-btn text-xs font-medium px-3 py-1 rounded-lg text-neutral-500 hover:bg-neutral-100" data-tab="losers">Düşenler</button>
                        </div>
                        <span class="text-xs text-neutral-400 font-sans">BIST 100</span>
                    </div>
                    <div id="gainers-list" class="p-4 space-y-2">
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-emerald-600 w-4">1</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">KOZAL</span>
                            </div>
                            <span class="text-xs font-medium text-emerald-600 px-2 py-0.5 rounded-full" style="background-color: #D1FAE5;">+9.87%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-emerald-600 w-4">2</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">PGSUS</span>
                            </div>
                            <span class="text-xs font-medium text-emerald-600 px-2 py-0.5 rounded-full" style="background-color: #D1FAE5;">+7.23%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-emerald-600 w-4">3</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">TUPRS</span>
                            </div>
                            <span class="text-xs font-medium text-emerald-600 px-2 py-0.5 rounded-full" style="background-color: #D1FAE5;">+5.45%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-emerald-600 w-4">4</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">SAHOL</span>
                            </div>
                            <span class="text-xs font-medium text-emerald-600 px-2 py-0.5 rounded-full" style="background-color: #D1FAE5;">+4.12%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-emerald-600 w-4">5</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">KCHOL</span>
                            </div>
                            <span class="text-xs font-medium text-emerald-600 px-2 py-0.5 rounded-full" style="background-color: #D1FAE5;">+3.89%</span>
                        </div>
                    </div>
                    <div id="losers-list" class="p-4 space-y-2 hidden">
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-red-500 w-4">1</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">VESTL</span>
                            </div>
                            <span class="text-xs font-medium text-red-500 px-2 py-0.5 rounded-full" style="background-color: #FEE2E2;">-6.54%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-red-500 w-4">2</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">ARCLK</span>
                            </div>
                            <span class="text-xs font-medium text-red-500 px-2 py-0.5 rounded-full" style="background-color: #FEE2E2;">-4.21%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-red-500 w-4">3</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">TOASO</span>
                            </div>
                            <span class="text-xs font-medium text-red-500 px-2 py-0.5 rounded-full" style="background-color: #FEE2E2;">-3.87%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-red-500 w-4">4</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">FROTO</span>
                            </div>
                            <span class="text-xs font-medium text-red-500 px-2 py-0.5 rounded-full" style="background-color: #FEE2E2;">-2.95%</span>
                        </div>
                        <div class="flex items-center justify-between p-2 hover:bg-neutral-50 rounded-lg transition-colors">
                            <div class="flex items-center gap-2">
                                <span class="text-xs font-bold text-red-500 w-4">5</span>
                                <span class="text-xs font-medium text-neutral-900 font-sans">BIMAS</span>
                            </div>
                            <span class="text-xs font-medium text-red-500 px-2 py-0.5 rounded-full" style="background-color: #FEE2E2;">-2.33%</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Second Row: Agent Activity Log, Twitter Feed & Risk Meter -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">

                <!-- Agent Activity Log -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></div>
                            <h3 class="text-sm font-medium text-neutral-900 font-sans">Agent Aktivite Logu</h3>
                        </div>
                        <div class="flex items-center gap-2">
                            <select id="agent-log-filter" class="text-xs bg-neutral-100 rounded-lg px-2 py-1 font-sans" style="border: 2px solid #000000;">
                                <option value="all">Tümü</option>
                                <option value="trade">İşlemler</option>
                                <option value="analysis">Analizler</option>
                                <option value="alert">Uyarılar</option>
                            </select>
                        </div>
                    </div>
                    <div id="agent-activity-log" class="p-4 space-y-3 max-h-72 overflow-y-auto">
                        <div class="log-entry flex items-start gap-3 p-3 bg-neutral-50 rounded-xl" data-type="trade" style="border: 2px solid #000000;">
                            <div class="w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#171717" stroke-width="2.5"><path d="M7 7h10v10"></path><path d="M7 17 17 7"></path></svg>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-semibold text-neutral-900 font-sans">Trend Takipçi</span>
                                    <span class="text-xs text-neutral-500 font-sans font-medium">12:45:32</span>
                                </div>
                                <p class="text-xs text-neutral-600 font-sans mt-1">THYAO alım emri gerçekleşti - ₺25,000</p>
                                <span class="inline-block mt-1.5 text-xs px-2 py-0.5 rounded-full font-medium" style="background-color: #E8FF5A; border: 1px solid #000000;">ALIM</span>
                            </div>
                        </div>
                        <div class="log-entry flex items-start gap-3 p-3 bg-neutral-50 rounded-xl" data-type="analysis" style="border: 2px solid #000000;">
                            <div class="w-7 h-7 bg-neutral-900 rounded-lg flex items-center justify-center flex-shrink-0" style="border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-semibold text-neutral-900 font-sans">Risk Yöneticisi</span>
                                    <span class="text-xs text-neutral-500 font-sans font-medium">12:42:18</span>
                                </div>
                                <p class="text-xs text-neutral-600 font-sans mt-1">Portföy risk analizi tamamlandı - Seviye: Düşük</p>
                                <span class="inline-block mt-1.5 text-xs px-2 py-0.5 rounded-full font-medium bg-neutral-200 text-neutral-700" style="border: 1px solid #000000;">ANALİZ</span>
                            </div>
                        </div>
                        <div class="log-entry flex items-start gap-3 p-3 bg-neutral-50 rounded-xl" data-type="alert" style="border: 2px solid #000000;">
                            <div class="w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#171717" stroke-width="2.5"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-semibold text-neutral-900 font-sans">Sistem</span>
                                    <span class="text-xs text-neutral-500 font-sans font-medium">12:38:05</span>
                                </div>
                                <p class="text-xs text-neutral-600 font-sans mt-1">BIST 100 volatilite uyarısı - Normal seviyenin üzerinde</p>
                                <span class="inline-block mt-1.5 text-xs px-2 py-0.5 rounded-full font-medium bg-neutral-900 text-white" style="border: 1px solid #000000;">UYARI</span>
                            </div>
                        </div>
                        <div class="log-entry flex items-start gap-3 p-3 bg-neutral-50 rounded-xl" data-type="analysis" style="border: 2px solid #000000;">
                            <div class="w-7 h-7 bg-neutral-900 rounded-lg flex items-center justify-center flex-shrink-0" style="border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-semibold text-neutral-900 font-sans">Zamanlayıcı</span>
                                    <span class="text-xs text-neutral-500 font-sans font-medium">12:30:00</span>
                                </div>
                                <p class="text-xs text-neutral-600 font-sans mt-1">DCA işlemi planlandı - Sonraki: 14:00</p>
                                <span class="inline-block mt-1.5 text-xs px-2 py-0.5 rounded-full font-medium bg-neutral-200 text-neutral-700" style="border: 1px solid #000000;">PLANLI</span>
                            </div>
                        </div>
                        <div class="log-entry flex items-start gap-3 p-3 bg-neutral-50 rounded-xl" data-type="trade" style="border: 2px solid #000000;">
                            <div class="w-7 h-7 bg-neutral-900 rounded-lg flex items-center justify-center flex-shrink-0" style="border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><path d="m7 7 10 10"></path><path d="M17 7v10H7"></path></svg>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-semibold text-neutral-900 font-sans">Trend Takipçi</span>
                                    <span class="text-xs text-neutral-500 font-sans font-medium">12:15:44</span>
                                </div>
                                <p class="text-xs text-neutral-600 font-sans mt-1">EREGL satım emri gerçekleşti - ₺18,500</p>
                                <span class="inline-block mt-1.5 text-xs px-2 py-0.5 rounded-full font-medium bg-neutral-900 text-white" style="border: 1px solid #000000;">SATIM</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Twitter/X Haber Akışı -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-5 py-3" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <div class="w-7 h-7 bg-neutral-900 rounded-lg flex items-center justify-center" style="border: 2px solid #000000;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="white"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                                </div>
                                <h3 class="text-sm font-semibold text-neutral-900 font-sans">Piyasa Haberleri</h3>
                            </div>
                            <div class="flex items-center gap-1.5">
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                                <span class="text-xs text-neutral-500 font-sans">Canlı</span>
                            </div>
                        </div>
                    </div>
                    <div id="twitter-feed" class="p-3 space-y-2 max-h-72 overflow-y-auto">
                        <!-- Tweet 1 -->
                        <div class="tweet-item p-3 rounded-xl transition-colors hover:bg-neutral-50" style="border: 2px solid #000000;">
                            <div class="flex items-start gap-3">
                                <div class="w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                    <span class="text-xs font-bold">BB</span>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-sm font-semibold text-neutral-900 font-sans">Bloomberg Türkiye</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="#1D9BF0"><path d="M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .494.083.964.237 1.4-1.272.65-2.147 2.018-2.147 3.6 0 1.495.782 2.798 1.942 3.486-.02.17-.032.34-.032.514 0 2.21 1.708 4 3.818 4 .47 0 .92-.086 1.335-.25.62 1.334 1.926 2.25 3.437 2.25 1.512 0 2.818-.916 3.437-2.25.415.163.865.248 1.336.248 2.11 0 3.818-1.79 3.818-4 0-.174-.012-.344-.033-.513 1.158-.687 1.943-1.99 1.943-3.484zm-6.616-3.334l-4.334 6.5c-.145.217-.382.334-.625.334-.143 0-.288-.04-.416-.126l-.115-.094-2.415-2.415c-.293-.293-.293-.768 0-1.06s.768-.294 1.06 0l1.77 1.767 3.825-5.74c.23-.345.696-.436 1.04-.207.346.23.44.696.21 1.04z"/></svg>
                                        <span class="text-xs text-neutral-400 font-sans">3dk</span>
                                    </div>
                                    <p class="text-xs text-neutral-700 font-sans leading-relaxed">📈 <span class="font-semibold">#THYAO</span> hissesi güçlü talep ile %2.5 yükseldi. Analistler hedef fiyatı ₺310'a revize etti. <span class="text-blue-500">#BIST100</span></p>
                                    <div class="flex items-center gap-3 mt-2">
                                        <span class="text-xs px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700 font-sans">Pozitif</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Tweet 2 -->
                        <div class="tweet-item p-3 rounded-xl transition-colors hover:bg-neutral-50" style="border: 2px solid #000000;">
                            <div class="flex items-start gap-3">
                                <div class="w-8 h-8 bg-neutral-900 rounded-full flex-shrink-0 flex items-center justify-center" style="border: 2px solid #000000;">
                                    <span class="text-xs font-bold text-white">FT</span>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-sm font-semibold text-neutral-900 font-sans">Finans Twitter</span>
                                        <span class="text-xs text-neutral-400 font-sans">12dk</span>
                                    </div>
                                    <p class="text-xs text-neutral-700 font-sans leading-relaxed">⚠️ TCMB faiz kararı öncesi piyasalarda temkinli hava. USD/TRY 32.50 seviyesinde dalgalanıyor. <span class="text-blue-500">#DolarTL</span></p>
                                    <div class="flex items-center gap-3 mt-2">
                                        <span class="text-xs px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-700 font-sans">Nötr</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Tweet 3 -->
                        <div class="tweet-item p-3 rounded-xl transition-colors hover:bg-neutral-50" style="border: 2px solid #000000;">
                            <div class="flex items-start gap-3">
                                <div class="w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                    <span class="text-xs font-bold">EA</span>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-sm font-semibold text-neutral-900 font-sans">Ekonomi Analiz</span>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="#1D9BF0"><path d="M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .494.083.964.237 1.4-1.272.65-2.147 2.018-2.147 3.6 0 1.495.782 2.798 1.942 3.486-.02.17-.032.34-.032.514 0 2.21 1.708 4 3.818 4 .47 0 .92-.086 1.335-.25.62 1.334 1.926 2.25 3.437 2.25 1.512 0 2.818-.916 3.437-2.25.415.163.865.248 1.336.248 2.11 0 3.818-1.79 3.818-4 0-.174-.012-.344-.033-.513 1.158-.687 1.943-1.99 1.943-3.484zm-6.616-3.334l-4.334 6.5c-.145.217-.382.334-.625.334-.143 0-.288-.04-.416-.126l-.115-.094-2.415-2.415c-.293-.293-.293-.768 0-1.06s.768-.294 1.06 0l1.77 1.767 3.825-5.74c.23-.345.696-.436 1.04-.207.346.23.44.696.21 1.04z"/></svg>
                                        <span class="text-xs text-neutral-400 font-sans">25dk</span>
                                    </div>
                                    <p class="text-xs text-neutral-700 font-sans leading-relaxed">🔴 <span class="font-semibold">#EREGL</span> için kar satışı baskısı. Teknik göstergeler aşırı alım bölgesinde. Kısa vadeli düzeltme beklentisi. <span class="text-blue-500">#Borsa</span></p>
                                    <div class="flex items-center gap-3 mt-2">
                                        <span class="text-xs px-2 py-0.5 rounded-full bg-red-100 text-red-700 font-sans">Negatif</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Tweet 4 -->
                        <div class="tweet-item p-3 rounded-xl transition-colors hover:bg-neutral-50" style="border: 2px solid #000000;">
                            <div class="flex items-start gap-3">
                                <div class="w-8 h-8 bg-neutral-900 rounded-full flex-shrink-0 flex items-center justify-center" style="border: 2px solid #000000;">
                                    <span class="text-xs font-bold text-white">BH</span>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="text-sm font-semibold text-neutral-900 font-sans">Borsa Haberleri</span>
                                        <span class="text-xs text-neutral-400 font-sans">42dk</span>
                                    </div>
                                    <p class="text-xs text-neutral-700 font-sans leading-relaxed">💰 <span class="font-semibold">#GARAN</span> bilançosu beklentilerin üzerinde! Net kâr %45 arttı. Hisse açılışta %3 primli. <span class="text-blue-500">#BankaSektörü</span></p>
                                    <div class="flex items-center gap-3 mt-2">
                                        <span class="text-xs px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700 font-sans">Pozitif</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Risk Meter - Professional Design -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <!-- Header -->
                    <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#171717" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                            </div>
                            <div>
                                <h3 class="text-sm font-semibold text-neutral-900 font-sans">Risk Analizi</h3>
                                <p class="text-xs text-neutral-500 font-sans">Gerçek zamanlı izleme</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-2 h-2 rounded-full animate-pulse" style="background-color: #E8FF5A;"></div>
                            <span id="risk-update-time" class="text-xs text-neutral-500 font-sans">Şimdi</span>
                        </div>
                    </div>

                    <!-- Main Gauge Area -->
                    <div class="relative px-6 pt-8 pb-4" style="background: linear-gradient(180deg, #FAFAFA 0%, #FFFFFF 100%);">
                        <!-- Risk Gauge SVG -->
                        <div class="flex justify-center">
                            <div class="relative w-56 h-32">
                                <svg viewBox="0 0 200 110" class="w-full h-full" style="filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));">
                                    <defs>
                                        <!-- Gradient definitions -->
                                        <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                            <stop offset="0%" style="stop-color:#22C55E"/>
                                            <stop offset="25%" style="stop-color:#84CC16"/>
                                            <stop offset="50%" style="stop-color:#E8FF5A"/>
                                            <stop offset="75%" style="stop-color:#EAB308"/>
                                            <stop offset="100%" style="stop-color:#EF4444"/>
                                        </linearGradient>
                                        <!-- Glow filter -->
                                        <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
                                            <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                                            <feMerge>
                                                <feMergeNode in="coloredBlur"/>
                                                <feMergeNode in="SourceGraphic"/>
                                            </feMerge>
                                        </filter>
                                    </defs>

                                    <!-- Background track -->
                                    <path d="M 20 95 A 80 80 0 0 1 180 95" fill="none" stroke="#E5E5E5" stroke-width="16" stroke-linecap="round"/>

                                    <!-- Colored arc with gradient -->
                                    <path d="M 20 95 A 80 80 0 0 1 180 95" fill="none" stroke="url(#gaugeGradient)" stroke-width="16" stroke-linecap="round"/>

                                    <!-- Tick marks -->
                                    <g stroke="#171717" stroke-width="2">
                                        <line x1="20" y1="95" x2="28" y2="95"/>
                                        <line x1="35" y1="55" x2="42" y2="60"/>
                                        <line x1="70" y1="25" x2="74" y2="32"/>
                                        <line x1="100" y1="15" x2="100" y2="23"/>
                                        <line x1="130" y1="25" x2="126" y2="32"/>
                                        <line x1="165" y1="55" x2="158" y2="60"/>
                                        <line x1="180" y1="95" x2="172" y2="95"/>
                                    </g>

                                    <!-- Needle with animation -->
                                    <g id="risk-needle-group" style="transform-origin: 100px 95px; transition: transform 1s cubic-bezier(0.34, 1.56, 0.64, 1);">
                                        <!-- Needle shadow -->
                                        <line x1="100" y1="95" x2="100" y2="35" stroke="rgba(0,0,0,0.2)" stroke-width="6" stroke-linecap="round" transform="translate(2, 2)"/>
                                        <!-- Main needle -->
                                        <line id="risk-needle" x1="100" y1="95" x2="100" y2="35" stroke="#171717" stroke-width="5" stroke-linecap="round"/>
                                        <!-- Needle tip accent -->
                                        <circle cx="100" cy="38" r="4" fill="#E8FF5A" stroke="#171717" stroke-width="2"/>
                                    </g>

                                    <!-- Center hub -->
                                    <circle cx="100" cy="95" r="14" fill="#171717"/>
                                    <circle cx="100" cy="95" r="8" fill="#E8FF5A"/>
                                    <circle cx="100" cy="95" r="4" fill="#171717"/>
                                </svg>

                                <!-- Labels under gauge -->
                                <div class="absolute bottom-0 left-0 right-0 flex justify-between px-2 text-xs font-medium text-neutral-400 font-sans">
                                    <span>Düşük</span>
                                    <span>Yüksek</span>
                                </div>
                            </div>
                        </div>

                        <!-- Risk Level Display -->
                        <div class="text-center mt-4">
                            <div id="risk-level-badge" class="inline-flex items-center gap-2 px-4 py-2 rounded-xl" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <div id="risk-level-icon" class="w-5 h-5 rounded-full flex items-center justify-center" style="background-color: #171717;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#E8FF5A" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
                                </div>
                                <span id="risk-level-text" class="text-lg font-bold text-neutral-900 font-sans tracking-tight">DÜŞÜK</span>
                            </div>
                            <p id="risk-score" class="text-sm text-neutral-500 font-sans mt-2">Risk Skoru: <span class="font-bold text-neutral-900">28</span>/100</p>
                        </div>
                    </div>

                    <!-- Risk Metrics Grid -->
                    <div class="grid grid-cols-2 gap-3 p-4" style="background-color: #171717;">
                        <div class="p-4 rounded-xl bg-neutral-800" style="border: 2px solid #333;">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-xs text-neutral-400 font-sans font-medium">Volatilite</p>
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#E8FF5A" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                            </div>
                            <p id="risk-volatility" class="text-xl font-bold text-white font-sans">12.3%</p>
                            <div class="w-full h-1.5 bg-neutral-700 rounded-full mt-3 overflow-hidden">
                                <div id="risk-volatility-bar" class="h-full rounded-full transition-all duration-1000" style="width: 25%; background: linear-gradient(90deg, #22C55E, #E8FF5A);"></div>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl bg-neutral-800" style="border: 2px solid #333;">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-xs text-neutral-400 font-sans font-medium">Sharpe Oranı</p>
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#E8FF5A" stroke-width="2"><path d="M12 20V10"/><path d="M18 20V4"/><path d="M6 20v-4"/></svg>
                            </div>
                            <p id="risk-sharpe" class="text-xl font-bold text-white font-sans">1.45</p>
                            <div class="w-full h-1.5 bg-neutral-700 rounded-full mt-3 overflow-hidden">
                                <div id="risk-sharpe-bar" class="h-full rounded-full transition-all duration-1000" style="width: 72%; background: linear-gradient(90deg, #E8FF5A, #22C55E);"></div>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl bg-neutral-800" style="border: 2px solid #333;">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-xs text-neutral-400 font-sans font-medium">Max Drawdown</p>
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#EAB308" stroke-width="2"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><path d="M21 12h-4l-3-9-3 9h-4"/></svg>
                            </div>
                            <p id="risk-drawdown" class="text-xl font-bold text-white font-sans">-8.5%</p>
                            <div class="w-full h-1.5 bg-neutral-700 rounded-full mt-3 overflow-hidden">
                                <div id="risk-drawdown-bar" class="h-full rounded-full transition-all duration-1000" style="width: 35%; background: linear-gradient(90deg, #EAB308, #EF4444);"></div>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl bg-neutral-800" style="border: 2px solid #333;">
                            <div class="flex items-center justify-between mb-2">
                                <p class="text-xs text-neutral-400 font-sans font-medium">Beta</p>
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#E8FF5A" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                            </div>
                            <p id="risk-beta" class="text-xl font-bold text-white font-sans">0.85</p>
                            <div class="w-full h-1.5 bg-neutral-700 rounded-full mt-3 overflow-hidden">
                                <div id="risk-beta-bar" class="h-full rounded-full transition-all duration-1000" style="width: 42%; background: linear-gradient(90deg, #22C55E, #84CC16);"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Risk Summary Footer -->
                    <div class="px-5 py-3 flex items-center justify-between" style="background-color: #E8FF5A; border-top: 2px solid #000000;">
                        <div class="flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#171717" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>
                            <span class="text-xs font-semibold text-neutral-900 font-sans">Portföy Koruması Aktif</span>
                        </div>
                        <button onclick="NurolApp.showToast('Portföy koruması: Stop-loss %5, Trailing stop aktif, Hedge oranı %15', 'info')" class="text-xs font-medium text-neutral-700 font-sans hover:text-neutral-900 transition-colors">Detaylar →</button>
                    </div>
                </div>
            </div>

            <!-- D3.js Charts Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">

                <!-- Sektör Bazlı Portföy Dağılımı - Stacked Horizontal Bar Chart -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-6 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-xl flex items-center justify-center overflow-hidden" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <img src="logolar/nurolagent-logo (2).png" alt="Nurol Agent" class="w-7 h-7 object-contain">
                            </div>
                            <div>
                                <h3 class="text-sm font-semibold text-neutral-900 font-sans">Sektör Bazlı Dağılım</h3>
                                <p class="text-xs text-neutral-500 font-sans">Varlık türlerine göre</p>
                            </div>
                        </div>
                        <div id="sector-chart-legend" class="flex items-center gap-2 text-xs font-sans"></div>
                    </div>
                    <div class="px-4 py-4">
                        <div id="sector-stacked-chart" style="width: 100%; min-height: 320px;"></div>
                    </div>
                    <div class="px-5 py-2.5 flex items-center justify-between" style="background-color: #171717;">
                        <span class="text-xs text-neutral-400 font-sans">Toplam: <span class="text-white font-bold">₺2.84M</span></span>
                        <span class="text-xs text-neutral-500 font-sans"><span id="sector-chart-time">--:--</span></span>
                    </div>
                </div>

                <!-- Sektör Korelasyon Ağı - D3.js Hierarchical Edge Bundling -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-6 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 rounded-xl flex items-center justify-center overflow-hidden" style="background-color: #171717; border: 2px solid #000000;">
                                <img src="logolar/nurolagent-logo (2).png" alt="Nurol Agent" class="w-7 h-7 object-contain">
                            </div>
                            <div>
                                <h3 class="text-sm font-semibold text-neutral-900 font-sans">Sektör Korelasyon Ağı</h3>
                                <p class="text-xs text-neutral-500 font-sans">Varlıklar arası ilişki haritası</p>
                            </div>
                        </div>
                        <span class="inline-flex items-center gap-1.5 px-3 py-1 rounded-lg text-xs font-medium" style="background-color: #E8FF5A; border: 1.5px solid #000000;">AI Analiz</span>
                    </div>
                    <div class="flex items-center justify-center p-4" style="background: radial-gradient(circle at center, #fafafa 0%, #f0f0f0 100%);">
                        <div id="edge-bundling-chart" style="width: 100%; max-width: 480px; aspect-ratio: 1;"></div>
                    </div>
                    <div class="px-5 py-2.5 flex items-center justify-between" style="background-color: #171717;">
                        <span class="text-xs text-neutral-400 font-sans">Korelasyon: <span class="text-[#E8FF5A] font-bold">32 bağlantı</span></span>
                        <span class="text-xs text-neutral-500 font-sans"><span id="edge-chart-time">--:--</span></span>
                    </div>
                </div>

            </div>

            </div><!-- End Dashboard Page -->

            <!-- Portfolio Page -->
            <div id="page-portfolio" class="page-content hidden">
                <div class="mb-8 flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-light text-neutral-900 tracking-tight font-google-sans-flex">Portföy Detayları</h1>
                        <p class="text-base text-neutral-500 mt-1 font-sans">Tüm yatırımlarınızın detaylı görünümü</p>
                    </div>
                    <button onclick="NurolApp.showToast('Portföy raporu hazırlanıyor...', 'success')" class="text-xs px-4 py-2 rounded-lg font-sans hover:opacity-80 transition-opacity flex items-center gap-1.5" style="background-color: #E8FF5A; border: 2px solid #000000;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        Rapor İndir
                    </button>
                </div>

                <!-- Portfolio Summary -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-white rounded-2xl p-5" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Toplam Değer</p>
                        <p class="text-2xl font-light text-neutral-900 font-google-sans-flex mt-1">₺2.84M</p>
                        <p class="text-xs text-emerald-600 font-medium font-sans mt-2">+₺312K bugün</p>
                    </div>
                    <div class="bg-white rounded-2xl p-5" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Hisse Senedi</p>
                        <p class="text-2xl font-light text-neutral-900 font-google-sans-flex mt-1">₺1.92M</p>
                        <p class="text-xs text-neutral-400 font-sans mt-2">%67.6 oran</p>
                    </div>
                    <div class="bg-white rounded-2xl p-5" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Yatırım Fonları</p>
                        <p class="text-2xl font-light text-neutral-900 font-google-sans-flex mt-1">₺680K</p>
                        <p class="text-xs text-neutral-400 font-sans mt-2">%23.9 oran</p>
                    </div>
                    <div class="bg-white rounded-2xl p-5" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Nakit</p>
                        <p class="text-2xl font-light text-neutral-900 font-google-sans-flex mt-1">₺240K</p>
                        <p class="text-xs text-neutral-400 font-sans mt-2">%8.5 oran</p>
                    </div>
                </div>

                <!-- Holdings Table -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <h3 class="text-sm font-semibold text-neutral-900 font-sans">Varlıklarım</h3>
                        <div class="flex gap-2" id="portfolio-filter-btns">
                            <button class="pf-filter-btn text-xs px-3 py-1.5 rounded-lg font-sans" data-filter="all" style="background-color: #E8FF5A; border: 2px solid #000000;">Tümü</button>
                            <button class="pf-filter-btn text-xs px-3 py-1.5 rounded-lg text-neutral-500 hover:bg-neutral-100 font-sans" data-filter="hisse">Hisseler</button>
                            <button class="pf-filter-btn text-xs px-3 py-1.5 rounded-lg text-neutral-500 hover:bg-neutral-100 font-sans" data-filter="fon">Fonlar</button>
                        </div>
                    </div>
                    <div class="divide-y divide-neutral-100" id="portfolio-holdings">
                        <div class="holding-row flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" data-type="hisse" data-symbol="THYAO">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-neutral-900 rounded-xl flex items-center justify-center" style="border: 2px solid #000000;"><span class="text-white text-xs font-bold">TH</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">THYAO</p>
                                    <p class="text-xs text-neutral-500 font-sans">250 adet</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺71,850</p>
                                <p class="text-xs text-emerald-600 font-sans">+12.4%</p>
                            </div>
                        </div>
                        <div class="holding-row flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" data-type="hisse" data-symbol="GARAN">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;"><span class="text-neutral-900 text-xs font-bold">GA</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">GARAN</p>
                                    <p class="text-xs text-neutral-500 font-sans">500 adet</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺49,375</p>
                                <p class="text-xs text-red-500 font-sans">-2.1%</p>
                            </div>
                        </div>
                        <div class="holding-row flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" data-type="hisse" data-symbol="ASELS">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-neutral-900 rounded-xl flex items-center justify-center" style="border: 2px solid #000000;"><span class="text-white text-xs font-bold">AS</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">ASELS</p>
                                    <p class="text-xs text-neutral-500 font-sans">1,200 adet</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺65,040</p>
                                <p class="text-xs text-emerald-600 font-sans">+5.8%</p>
                            </div>
                        </div>
                        <div class="holding-row flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" data-type="hisse" data-symbol="EREGL">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;"><span class="text-neutral-900 text-xs font-bold">ER</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">EREGL</p>
                                    <p class="text-xs text-neutral-500 font-sans">800 adet</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺43,360</p>
                                <p class="text-xs text-emerald-600 font-sans">+3.2%</p>
                            </div>
                        </div>
                        <div class="holding-row flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" data-type="fon" data-symbol="ISFON">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;"><span class="text-neutral-900 text-xs font-bold">İŞ</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">İş Portföy Hisse Fonu</p>
                                    <p class="text-xs text-neutral-500 font-sans">Fon • ₺180K yatırım</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺207,000</p>
                                <p class="text-xs text-emerald-600 font-sans">+15.0%</p>
                            </div>
                        </div>
                        <div class="holding-row flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" data-type="fon" data-symbol="AKFON">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-neutral-900 rounded-xl flex items-center justify-center" style="border: 2px solid #000000;"><span class="text-white text-xs font-bold">AK</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">Ak Portföy Tahvil Fonu</p>
                                    <p class="text-xs text-neutral-500 font-sans">Fon • ₺250K yatırım</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺273,000</p>
                                <p class="text-xs text-emerald-600 font-sans">+9.2%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- End Portfolio Page -->

            <!-- Funds Page -->
            <div id="page-funds" class="page-content hidden">
                <div class="mb-8">
                    <h1 class="text-2xl font-light text-neutral-900 tracking-tight font-google-sans-flex">Yatırım Fonları</h1>
                    <p class="text-base text-neutral-500 mt-1 font-sans">AI destekli fon önerileri ve portföy</p>
                </div>

                <!-- Fund Stats -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-white rounded-2xl p-5" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Toplam Fon Yatırımı</p>
                        <p class="text-2xl font-light text-neutral-900 font-google-sans-flex mt-1">₺680,000</p>
                        <p class="text-xs text-emerald-600 font-medium font-sans mt-2">+8.2% bu ay</p>
                    </div>
                    <div class="bg-white rounded-2xl p-5" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Aktif Fon Sayısı</p>
                        <p class="text-2xl font-light text-neutral-900 font-google-sans-flex mt-1">4</p>
                        <p class="text-xs text-neutral-400 font-sans mt-2">3 hisse, 1 tahvil</p>
                    </div>
                    <div class="bg-white rounded-2xl p-5" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Ort. Getiri</p>
                        <p class="text-2xl font-light text-emerald-600 font-google-sans-flex mt-1">+15.4%</p>
                        <p class="text-xs text-neutral-400 font-sans mt-2">yıllık</p>
                    </div>
                </div>

                <!-- AI Recommended Funds -->
                <div class="bg-white rounded-2xl overflow-hidden mb-6" style="border: 2px solid #000000;">
                    <div class="px-5 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-lg flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
                            </div>
                            <h3 class="text-sm font-semibold text-neutral-900 font-sans">AI Fon Önerileri</h3>
                        </div>
                        <span class="text-xs px-2 py-1 rounded-full font-sans" style="background-color: #E8FF5A; border: 2px solid #000000;">Güncel</span>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4">
                        <div class="p-4 rounded-xl" style="border: 2px solid #000000;">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-semibold text-neutral-900 font-sans">TEB Hisse Fonu</span>
                                <span class="text-xs px-2 py-0.5 rounded-full bg-emerald-100 text-emerald-700 font-sans">Önerilen</span>
                            </div>
                            <p class="text-xs text-neutral-500 font-sans mb-2">BIST 30 ağırlıklı, düşük risk</p>
                            <div class="flex items-center justify-between">
                                <span class="text-lg font-light text-emerald-600 font-google-sans-flex">+18.5%</span>
                                <button class="fund-invest-btn text-xs px-3 py-1.5 rounded-lg font-sans hover:opacity-80 transition-opacity" data-fund="TEB Hisse Fonu" data-price="142.50" style="background-color: #E8FF5A; border: 2px solid #000000;">Yatırım Yap</button>
                            </div>
                        </div>
                        <div class="p-4 rounded-xl" style="border: 2px solid #000000;">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm font-semibold text-neutral-900 font-sans">Yapı Kredi Portföy</span>
                                <span class="text-xs px-2 py-0.5 rounded-full bg-blue-100 text-blue-700 font-sans">Dengeli</span>
                            </div>
                            <p class="text-xs text-neutral-500 font-sans mb-2">Karma fon, orta risk</p>
                            <div class="flex items-center justify-between">
                                <span class="text-lg font-light text-emerald-600 font-google-sans-flex">+12.3%</span>
                                <button class="fund-invest-btn text-xs px-3 py-1.5 rounded-lg font-sans hover:opacity-80 transition-opacity" data-fund="Yapı Kredi Portföy" data-price="98.20" style="background-color: #E8FF5A; border: 2px solid #000000;">Yatırım Yap</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- My Funds -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-5 py-4" style="border-bottom: 2px solid #000000;">
                        <h3 class="text-sm font-semibold text-neutral-900 font-sans">Fonlarım</h3>
                    </div>
                    <div class="divide-y divide-neutral-100">
                        <div class="flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" onclick="NurolApp.openTradeModal('İş Portföy Hisse', 115.00)">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: #E8FF5A; border: 2px solid #000000;"><span class="text-neutral-900 text-xs font-bold">İŞ</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">İş Portföy Hisse Fonu</p>
                                    <p class="text-xs text-neutral-500 font-sans">₺180,000 yatırım</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺207,000</p>
                                <p class="text-xs text-emerald-600 font-sans">+15.0%</p>
                            </div>
                        </div>
                        <div class="flex items-center justify-between p-4 hover:bg-neutral-50 transition-colors cursor-pointer" onclick="NurolApp.openTradeModal('Ak Portföy Tahvil', 109.20)">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-neutral-900 rounded-xl flex items-center justify-center" style="border: 2px solid #000000;"><span class="text-white text-xs font-bold">AK</span></div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">Ak Portföy Tahvil Fonu</p>
                                    <p class="text-xs text-neutral-500 font-sans">₺250,000 yatırım</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺273,000</p>
                                <p class="text-xs text-emerald-600 font-sans">+9.2%</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- End Funds Page -->

            <!-- History Page -->
            <div id="page-history" class="page-content hidden">
                <div class="mb-8 flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-light text-neutral-900 tracking-tight font-google-sans-flex">İşlem Geçmişi</h1>
                        <p class="text-base text-neutral-500 mt-1 font-sans">Tüm alım-satım işlemleriniz</p>
                    </div>
                    <button onclick="NurolApp.showToast('İşlem raporu PDF olarak hazırlanıyor...', 'success')" class="text-xs px-4 py-2 rounded-lg font-sans hover:opacity-80 transition-opacity flex items-center gap-1.5" style="background-color: #E8FF5A; border: 2px solid #000000;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        Rapor İndir
                    </button>
                </div>

                <!-- History Filters -->
                <div class="flex items-center gap-4 mb-6">
                    <div class="flex gap-2 rounded-xl p-1 bg-neutral-100" id="history-filter-btns" style="border: 2px solid #000000;">
                        <button class="hist-filter-btn text-xs px-4 py-2 rounded-lg font-sans" data-filter="all" style="background-color: #E8FF5A;">Tümü</button>
                        <button class="hist-filter-btn text-xs px-4 py-2 rounded-lg text-neutral-500 font-sans" data-filter="buy">Alımlar</button>
                        <button class="hist-filter-btn text-xs px-4 py-2 rounded-lg text-neutral-500 font-sans" data-filter="sell">Satımlar</button>
                    </div>
                    <select id="history-date-filter" class="text-xs px-3 py-2 rounded-lg bg-white font-sans" style="border: 2px solid #000000;">
                        <option value="7">Son 7 gün</option>
                        <option value="30">Son 30 gün</option>
                        <option value="90">Son 3 ay</option>
                        <option value="all">Tüm zamanlar</option>
                    </select>
                </div>

                <!-- History Stats -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div class="bg-white rounded-2xl p-4" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Toplam İşlem</p>
                        <p class="text-xl font-light text-neutral-900 font-google-sans-flex mt-1">47</p>
                    </div>
                    <div class="bg-white rounded-2xl p-4" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Başarılı</p>
                        <p class="text-xl font-light text-emerald-600 font-google-sans-flex mt-1">45</p>
                    </div>
                    <div class="bg-white rounded-2xl p-4" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Hacim</p>
                        <p class="text-xl font-light text-neutral-900 font-google-sans-flex mt-1">₺1.2M</p>
                    </div>
                    <div class="bg-white rounded-2xl p-4" style="border: 2px solid #000000;">
                        <p class="text-xs text-neutral-500 font-sans">Net Kâr</p>
                        <p class="text-xl font-light text-emerald-600 font-google-sans-flex mt-1">+₺184K</p>
                    </div>
                </div>

                <!-- Transactions List -->
                <div class="bg-white rounded-2xl overflow-hidden" style="border: 2px solid #000000;">
                    <div class="px-5 py-4" style="border-bottom: 2px solid #000000;">
                        <h3 class="text-sm font-semibold text-neutral-900 font-sans">Son İşlemler</h3>
                    </div>
                    <div class="divide-y divide-neutral-100" id="history-transactions">
                        <div class="hist-row flex items-center justify-between p-4" data-type="buy">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center" style="border: 2px solid #059669;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">THYAO Alım</p>
                                    <p class="text-xs text-neutral-500 font-sans">50 adet @ ₺285.40</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺14,270</p>
                                <p class="text-xs text-neutral-400 font-sans">Bugün, 14:32</p>
                            </div>
                        </div>
                        <div class="hist-row flex items-center justify-between p-4" data-type="sell">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center" style="border: 2px solid #DC2626;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#DC2626" stroke-width="2"><path d="M17 17H7V7"/><path d="m7 17 10-10"/></svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">EREGL Satım</p>
                                    <p class="text-xs text-neutral-500 font-sans">200 adet @ ₺54.80</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺10,960</p>
                                <p class="text-xs text-neutral-400 font-sans">Bugün, 11:15</p>
                            </div>
                        </div>
                        <div class="hist-row flex items-center justify-between p-4" data-type="buy">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center" style="border: 2px solid #059669;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">GARAN Alım</p>
                                    <p class="text-xs text-neutral-500 font-sans">100 adet @ ₺97.50</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺9,750</p>
                                <p class="text-xs text-neutral-400 font-sans">Dün, 16:45</p>
                            </div>
                        </div>
                        <div class="hist-row flex items-center justify-between p-4" data-type="buy">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center" style="border: 2px solid #059669;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">ASELS Alım</p>
                                    <p class="text-xs text-neutral-500 font-sans">300 adet @ ₺52.10</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺15,630</p>
                                <p class="text-xs text-neutral-400 font-sans">2 gün önce</p>
                            </div>
                        </div>
                        <div class="hist-row flex items-center justify-between p-4" data-type="sell">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center" style="border: 2px solid #DC2626;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#DC2626" stroke-width="2"><path d="M17 17H7V7"/><path d="m7 17 10-10"/></svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">SISE Satım</p>
                                    <p class="text-xs text-neutral-500 font-sans">150 adet @ ₺46.20</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺6,930</p>
                                <p class="text-xs text-neutral-400 font-sans">3 gün önce</p>
                            </div>
                        </div>
                        <div class="hist-row flex items-center justify-between p-4" data-type="buy">
                            <div class="flex items-center gap-3">
                                <div class="w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center" style="border: 2px solid #059669;">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#059669" stroke-width="2"><path d="M7 7h10v10"/><path d="M7 17 17 7"/></svg>
                                </div>
                                <div>
                                    <p class="text-sm font-semibold text-neutral-900 font-sans">TUPRS Alım</p>
                                    <p class="text-xs text-neutral-500 font-sans">80 adet @ ₺142.60</p>
                                </div>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-neutral-900 font-sans">₺11,408</p>
                                <p class="text-xs text-neutral-400 font-sans">4 gün önce</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- End History Page -->

        </div>
    </main>

    <!-- Quick Trade Modal -->
    <div id="trade-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" id="trade-modal-overlay"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md">
            <div class="bg-white rounded-2xl overflow-hidden mx-4" style="border: 2px solid #000000;">
                <div class="px-6 py-4 flex items-center justify-between" style="border-bottom: 2px solid #000000;">
                    <h3 id="trade-modal-title" class="text-sm font-medium text-neutral-900 font-sans">Hızlı İşlem</h3>
                    <button id="trade-modal-close" class="p-1 hover:bg-neutral-100 rounded-lg transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
                <div class="p-6">
                    <div class="flex items-center gap-4 mb-6 p-4 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                        <div class="w-12 h-12 bg-neutral-900 rounded-xl flex items-center justify-center" style="border: 2px solid #000000;">
                            <span id="trade-modal-symbol-icon" class="text-white text-sm font-bold">TH</span>
                        </div>
                        <div>
                            <p id="trade-modal-symbol" class="text-lg font-medium text-neutral-900 font-sans">THYAO</p>
                            <p id="trade-modal-price" class="text-sm text-neutral-500 font-sans">Güncel Fiyat: ₺287.40</p>
                        </div>
                    </div>

                    <div class="space-y-4">
                        <div>
                            <label class="text-xs text-neutral-500 font-sans mb-1 block">İşlem Tipi</label>
                            <div class="flex gap-2">
                                <button id="trade-type-buy" class="flex-1 py-2 text-sm font-medium rounded-lg transition-colors" style="background-color: #E8FF5A; border: 2px solid #000000;">Alım</button>
                                <button id="trade-type-sell" class="flex-1 py-2 text-sm font-medium rounded-lg bg-neutral-100 text-neutral-700 transition-colors" style="border: 2px solid #000000;">Satım</button>
                            </div>
                        </div>

                        <div>
                            <label class="text-xs text-neutral-500 font-sans mb-1 block">Miktar (₺)</label>
                            <input id="trade-amount" type="number" placeholder="10,000" class="w-full px-4 py-3 bg-neutral-100 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-neutral-900/10" style="border: 2px solid #000000;">
                        </div>

                        <div class="flex gap-2">
                            <button class="trade-preset-btn flex-1 py-2 text-xs font-medium rounded-lg bg-neutral-100 hover:bg-neutral-200 transition-colors" style="border: 2px solid #000000;" data-amount="5000">₺5K</button>
                            <button class="trade-preset-btn flex-1 py-2 text-xs font-medium rounded-lg bg-neutral-100 hover:bg-neutral-200 transition-colors" style="border: 2px solid #000000;" data-amount="10000">₺10K</button>
                            <button class="trade-preset-btn flex-1 py-2 text-xs font-medium rounded-lg bg-neutral-100 hover:bg-neutral-200 transition-colors" style="border: 2px solid #000000;" data-amount="25000">₺25K</button>
                            <button class="trade-preset-btn flex-1 py-2 text-xs font-medium rounded-lg bg-neutral-100 hover:bg-neutral-200 transition-colors" style="border: 2px solid #000000;" data-amount="50000">₺50K</button>
                        </div>

                        <div class="p-3 bg-neutral-50 rounded-xl" style="border: 2px solid #000000;">
                            <div class="flex justify-between text-xs mb-1">
                                <span class="text-neutral-500 font-sans">Tahmini Adet</span>
                                <span id="trade-estimated-shares" class="text-neutral-900 font-medium font-sans">~34.8 adet</span>
                            </div>
                            <div class="flex justify-between text-xs">
                                <span class="text-neutral-500 font-sans">Komisyon</span>
                                <span class="text-neutral-900 font-medium font-sans">₺0 (Sıfır komisyon)</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="px-6 pb-6">
                    <button id="trade-confirm-btn" class="w-full py-3 text-sm font-medium rounded-xl transition-colors hover:opacity-90" style="background-color: #E8FF5A; border: 2px solid #000000;">
                        İşlemi Onayla
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="border-t border-neutral-200 bg-white">
        <div class="max-w-7xl mx-auto px-6 py-6">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-2">
                    <img src="logolar/nurolagent-logo.png" alt="Nurol Agent Logo" class="h-6 w-auto">
                    <span class="text-sm font-medium text-neutral-900 font-sans">Nurol Agent</span>
                    <span class="text-xs text-neutral-400 font-sans">© 2025</span>
                </div>
                <div class="flex items-center gap-6">
                    <a href="#" class="footer-link text-xs text-neutral-500 hover:text-neutral-900 transition-colors font-sans">Gizlilik</a>
                    <a href="#" class="footer-link text-xs text-neutral-500 hover:text-neutral-900 transition-colors font-sans">Kullanım Şartları</a>
                    <a href="#" class="footer-link text-xs text-neutral-500 hover:text-neutral-900 transition-colors font-sans">Yardım</a>
                    <a href="#" class="footer-link text-xs text-neutral-500 hover:text-neutral-900 transition-colors font-sans">İletişim</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script>
        // ============================================
        // NUROL AGENT UI - GLOBAL STATE & UTILITIES
        // ============================================

        const NurolApp = {
            // Global State
            state: {
                portfolio: {
                    total: 2840000,
                    dailyChange: 48700,
                    dailyChangePercent: 1.7,
                    monthlyChangePercent: 12.4
                },
                market: {
                    bist100: { value: 9847.32, change: 1.24, isOpen: true },
                    usdtry: { value: 32.45, change: -0.32 },
                    gold: { value: 2485, change: 0.87 }
                },
                agents: [
                    { id: 1, name: 'Trend Takipçi', type: 'Momentum', active: true, trades: 8, profit: 12450 },
                    { id: 2, name: 'Risk Yöneticisi', type: 'Koruma', active: true, funds: 4, riskLevel: 'Düşük' },
                    { id: 3, name: 'Zamanlayıcı', type: 'DCA', active: true, nextRun: '14:00', dailyAmount: 5000 }
                ],
                transactions: [
                    { id: 1, name: 'TEFAS Teknoloji', type: 'buy', source: 'Agent', amount: 25000, time: '12:45' },
                    { id: 2, name: 'İş Bankası Hisse', type: 'sell', source: 'Manuel', amount: 12500, time: '11:20' },
                    { id: 3, name: 'Yapı Kredi Altın', type: 'buy', source: 'Agent', amount: 50000, time: '10:05' }
                ],
                chat: {
                    messages: [
                        { id: 1, sender: 'ai', text: 'Portföyünüz bugün %1.7 artış gösterdi. TEFAS Teknoloji fonunuzda güçlü momentum var.', time: '10:32' }
                    ],
                    isTyping: false
                },
                notifications: [
                    { id: 1, text: 'BIST 100 %1.24 yükseldi', time: '12:30', read: false },
                    { id: 2, text: 'Trend Takipçi yeni işlem açtı', time: '12:45', read: false },
                    { id: 3, text: 'Günlük hedef %80 tamamlandı', time: '11:00', read: true }
                ],
                chartPeriod: '1H',
                currentPage: 'dashboard',
                watchlist: [
                    { symbol: 'THYAO', name: 'Türk Hava Yolları', price: 287.40, change: 2.34 },
                    { symbol: 'GARAN', name: 'Garanti BBVA', price: 98.75, change: -0.82 },
                    { symbol: 'ASELS', name: 'Aselsan', price: 54.20, change: 1.15 },
                    { symbol: 'SISE', name: 'Şişecam', price: 45.80, change: 0.44 }
                ],
                tradeModal: {
                    isOpen: false,
                    symbol: '',
                    price: 0,
                    type: 'buy',
                    amount: 10000
                },
                riskScore: 28
            },

            // AI Response Templates
            aiResponses: [
                'Portföyünüzdeki hisse fonları bugün %2.3 değer kazandı. Özellikle teknoloji sektörü güçlü performans gösteriyor.',
                'Risk analizi tamamlandı. Mevcut portföy dağılımınız hedeflerinizle uyumlu görünüyor.',
                'BIST 100 endeksi son 1 saatte %0.5 yükseldi. Trend Takipçi agent\'ı bu hareketi değerlendirmek için hazır.',
                'Altın fiyatları yükseliş trendinde. Portföyünüzdeki altın pozisyonu %20 ile dengeli seviyede.',
                'Bugün 3 agent aktif çalışıyor ve toplam 24 işlem gerçekleştirdi. Net kar: ₺48,700',
                'USD/TRY paritesi hafif düşüş gösteriyor. Döviz pozisyonlarınız için risk seviyesi düşük.',
                'Öneri: Mevcut piyasa koşullarında tahvil ağırlığını artırmayı düşünebilirsiniz.',
                'Haftalık performans raporu hazır. Detayları görmek için "Rapor" butonuna tıklayın.'
            ],

            // Fund Names for Random Transactions
            fundNames: [
                'TEFAS Teknoloji', 'İş Bankası Hisse', 'Yapı Kredi Altın', 'Garanti BBVA Tahvil',
                'Akbank Karma', 'QNB Finans Döviz', 'Ziraat Portföy', 'Vakıf Katılım',
                'Halk Yatırım', 'Deniz Portföy', 'TEB Özel', 'ING Dinamik'
            ],

            // Format number (e.g. 2840000 → "2.84M", 312000 → "312K")
            formatNumber: function(num) {
                if (num >= 1000000) return (num / 1000000).toFixed(2) + 'M';
                if (num >= 1000) return (num / 1000).toFixed(0) + 'K';
                return num.toLocaleString('tr-TR');
            },

            // Utility Functions
            utils: {
                formatCurrency: (amount) => {
                    if (amount >= 1000000) return '₺' + (amount / 1000000).toFixed(2) + 'M';
                    if (amount >= 1000) return '₺' + (amount / 1000).toFixed(1) + 'K';
                    return '₺' + amount.toLocaleString('tr-TR');
                },
                formatTime: () => {
                    const now = new Date();
                    return now.getHours().toString().padStart(2, '0') + ':' +
                           now.getMinutes().toString().padStart(2, '0');
                },
                randomInRange: (min, max) => Math.random() * (max - min) + min,
                randomInt: (min, max) => Math.floor(Math.random() * (max - min + 1)) + min,
                delay: (ms) => new Promise(resolve => setTimeout(resolve, ms))
            },

            // Initialize Application
            init: function() {
                lucide.createIcons();
                this.initChat();
                this.initMarketSimulation();
                this.initChartButtons();
                this.initAgentControls();
                this.initNotifications();
                this.initNavigation();
                this.startAgentSimulation();
                this.initInteractiveChart();
                this.initWatchlist();
                this.initTradeModal();
                this.initAIRecommendations();
                this.initTopMovers();
                this.initActivityLog();
                this.initRiskMeter();
                this.initTwitterFeed();
                this.initSectorStackedChart();
                this.initTreemapChart();
                this.initEdgeBundlingChart();
                this.initToastSystem();
                this.initPortfolioFilters();
                this.initHistoryFilters();
                this.initFundButtons();
                this.initFooterLinks();
                this.initHoldingClicks();
                this.initUserMenu();
                console.log('Nurol Agent UI initialized');
            },

            // Chat System
            initChat: function() {
                const input = document.querySelector('#chat-input');
                const sendBtn = document.querySelector('#chat-send-btn');
                const quickBtns = document.querySelectorAll('.quick-action-btn');

                if (sendBtn) {
                    sendBtn.addEventListener('click', () => this.sendMessage());
                }
                if (input) {
                    input.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') this.sendMessage();
                    });
                }
                quickBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const action = e.target.textContent.trim();
                        this.handleQuickAction(action);
                    });
                });
            },

            sendMessage: function() {
                const input = document.querySelector('#chat-input');
                const text = input?.value?.trim();
                if (!text) return;

                this.addChatMessage('user', text);
                input.value = '';
                this.showTypingIndicator();

                setTimeout(() => {
                    this.hideTypingIndicator();
                    const response = this.aiResponses[this.utils.randomInt(0, this.aiResponses.length - 1)];
                    this.addChatMessage('ai', response);
                }, 1500 + Math.random() * 1000);
            },

            addChatMessage: function(sender, text) {
                const container = document.querySelector('#chat-messages');
                if (!container) return;

                const time = this.utils.formatTime();
                const messageHtml = sender === 'ai' ? `
                    <div class="flex gap-3 chat-message-new">
                        <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center flex-shrink-0" style="border: 2px solid #000000;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 8V4H8"></path><rect width="16" height="12" x="4" y="8" rx="2"></rect><path d="M2 14h2"></path><path d="M20 14h2"></path><path d="M15 13v2"></path><path d="M9 13v2"></path></svg>
                        </div>
                        <div class="flex-1">
                            <div class="bg-neutral-100 rounded-2xl rounded-tl-md p-4 max-w-md" style="border: 2px solid #000000;">
                                <p class="text-sm text-neutral-700 font-sans">${text}</p>
                            </div>
                            <span class="text-xs text-neutral-400 mt-1 block font-sans">${time}</span>
                        </div>
                    </div>
                ` : `
                    <div class="flex gap-3 justify-end chat-message-new">
                        <div class="flex-1 flex flex-col items-end">
                            <div class="bg-neutral-900 text-white rounded-2xl rounded-tr-md p-4 max-w-md" style="border: 2px solid #000000;">
                                <p class="text-sm font-sans">${text}</p>
                            </div>
                            <span class="text-xs text-neutral-400 mt-1 block font-sans">${time}</span>
                        </div>
                        <div class="w-8 h-8 rounded-full bg-neutral-900 flex items-center justify-center text-white text-xs font-medium flex-shrink-0">AK</div>
                    </div>
                `;

                container.insertAdjacentHTML('beforeend', messageHtml);
                container.scrollTop = container.scrollHeight;
            },

            showTypingIndicator: function() {
                const container = document.querySelector('#chat-messages');
                if (!container) return;

                const typingHtml = `
                    <div class="flex gap-3" id="typing-indicator">
                        <div class="w-8 h-8 bg-neutral-900 rounded-lg flex items-center justify-center flex-shrink-0" style="border: 2px solid #000000;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5"><path d="M12 8V4H8"></path><rect width="16" height="12" x="4" y="8" rx="2"></rect><path d="M2 14h2"></path><path d="M20 14h2"></path><path d="M15 13v2"></path><path d="M9 13v2"></path></svg>
                        </div>
                        <div class="bg-neutral-100 rounded-2xl rounded-tl-md p-4" style="border: 2px solid #000000;">
                            <div class="flex gap-1">
                                <div class="w-2 h-2 bg-neutral-400 rounded-full animate-bounce" style="animation-delay: 0ms"></div>
                                <div class="w-2 h-2 bg-neutral-400 rounded-full animate-bounce" style="animation-delay: 150ms"></div>
                                <div class="w-2 h-2 bg-neutral-400 rounded-full animate-bounce" style="animation-delay: 300ms"></div>
                            </div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', typingHtml);
                container.scrollTop = container.scrollHeight;
            },

            hideTypingIndicator: function() {
                document.querySelector('#typing-indicator')?.remove();
            },

            handleQuickAction: function(action) {
                const responses = {
                    'Analiz Detayı': 'Detaylı portföy analizi: Hisse fonları %35, Tahvil %25, Altın %20, Diğer %20. Son 30 günde en iyi performans gösteren varlık: TEFAS Teknoloji (+8.2%)',
                    'Risk Raporu': 'Risk Değerlendirmesi: Genel risk seviyesi DÜŞÜK. Volatilite: %12.3. Sharpe Oranı: 1.45. Maksimum düşüş riski: %8.5',
                    'Öneri Al': 'Öneri: Mevcut piyasa koşullarında teknoloji fonlarındaki pozisyonunuzu koruyun. Altın ağırlığını %25\'e çıkarmayı düşünebilirsiniz.'
                };

                this.showTypingIndicator();
                setTimeout(() => {
                    this.hideTypingIndicator();
                    this.addChatMessage('ai', responses[action] || 'Bu özellik yakında aktif olacak.');
                }, 1000);
            },

            // Market Simulation
            initMarketSimulation: function() {
                setInterval(() => this.updateMarketData(), 3000);
            },

            updateMarketData: function() {
                const state = this.state.market;

                // BIST 100
                state.bist100.value += this.utils.randomInRange(-15, 20);
                state.bist100.change = this.utils.randomInRange(-0.5, 1.5);

                // USD/TRY
                state.usdtry.value += this.utils.randomInRange(-0.05, 0.05);
                state.usdtry.change = this.utils.randomInRange(-0.5, 0.5);

                // Gold
                state.gold.value += this.utils.randomInRange(-5, 8);
                state.gold.change = this.utils.randomInRange(-0.3, 1.0);

                this.renderMarketData();
            },

            flashPrice: function(el, isUp) {
                if (!el) return;
                el.classList.remove('price-flash-up', 'price-flash-down');
                void el.offsetWidth;
                el.classList.add(isUp ? 'price-flash-up' : 'price-flash-down');
            },

            renderMarketData: function() {
                const state = this.state.market;

                // BIST 100
                const bist = document.querySelector('#market-bist100');
                if (bist) {
                    var valEl = bist.querySelector('.value');
                    valEl.textContent = state.bist100.value.toFixed(2);
                    this.flashPrice(valEl, state.bist100.change >= 0);
                    const changeEl = bist.querySelector('.change');
                    const isPositive = state.bist100.change >= 0;
                    changeEl.textContent = (isPositive ? '+' : '') + state.bist100.change.toFixed(2) + '%';
                    changeEl.style.backgroundColor = isPositive ? '#E8FF5A' : '#FEE2E2';
                    changeEl.style.color = isPositive ? '#171717' : '#EF4444';
                }

                // USD/TRY
                const usd = document.querySelector('#market-usdtry');
                if (usd) {
                    var valEl2 = usd.querySelector('.value');
                    valEl2.textContent = state.usdtry.value.toFixed(2);
                    this.flashPrice(valEl2, state.usdtry.change >= 0);
                    const changeEl = usd.querySelector('.change');
                    const isPositive = state.usdtry.change >= 0;
                    changeEl.textContent = (isPositive ? '+' : '') + state.usdtry.change.toFixed(2) + '%';
                    changeEl.style.backgroundColor = isPositive ? '#E8FF5A' : '#FEE2E2';
                    changeEl.style.color = isPositive ? '#171717' : '#EF4444';
                }

                // Gold
                const gold = document.querySelector('#market-gold');
                if (gold) {
                    var valEl3 = gold.querySelector('.value');
                    valEl3.textContent = '₺' + state.gold.value.toLocaleString('tr-TR');
                    this.flashPrice(valEl3, state.gold.change >= 0);
                    const changeEl = gold.querySelector('.change');
                    const isPositive = state.gold.change >= 0;
                    changeEl.textContent = (isPositive ? '+' : '') + state.gold.change.toFixed(2) + '%';
                    changeEl.style.backgroundColor = isPositive ? '#E8FF5A' : '#FEE2E2';
                    changeEl.style.color = isPositive ? '#171717' : '#EF4444';
                }
            },

            // Chart Controls
            initChartButtons: function() {
                document.querySelectorAll('.chart-period-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.chart-period-btn').forEach(b => {
                            b.classList.remove('bg-neutral-100', 'text-neutral-900');
                            b.classList.add('text-neutral-500');
                        });
                        e.target.classList.add('bg-neutral-100', 'text-neutral-900');
                        e.target.classList.remove('text-neutral-500');
                        this.state.chartPeriod = e.target.dataset.period;
                        this.updateChart();
                    });
                });
            },

            updateChart: function() {
                const bars = document.querySelectorAll('.chart-bar');
                bars.forEach(bar => {
                    const newHeight = this.utils.randomInt(20, 90);
                    bar.style.height = newHeight + '%';
                    bar.style.transition = 'height 0.5s ease';
                });
            },

            // Agent Controls
            initAgentControls: function() {
                document.querySelectorAll('.agent-toggle').forEach(toggle => {
                    toggle.addEventListener('click', (e) => {
                        const agentId = parseInt(e.target.dataset.agentId);
                        this.toggleAgent(agentId);
                    });
                });
            },

            toggleAgent: function(agentId) {
                const agent = this.state.agents.find(a => a.id === agentId);
                if (agent) {
                    agent.active = !agent.active;
                    this.renderAgents();
                    this.addNotification(agent.active ?
                        `${agent.name} aktif edildi` :
                        `${agent.name} durduruldu`
                    );
                }
            },

            renderAgents: function() {
                // Agent status indicators will be updated
                this.state.agents.forEach(agent => {
                    const indicator = document.querySelector(`#agent-${agent.id}-status`);
                    if (indicator) {
                        indicator.style.backgroundColor = agent.active ? '#E8FF5A' : '#A3A3A3';
                    }
                });
            },

            startAgentSimulation: function() {
                setInterval(() => {
                    if (Math.random() > 0.7) {
                        this.simulateAgentTrade();
                    }
                }, 10000);
            },

            simulateAgentTrade: function() {
                const activeAgents = this.state.agents.filter(a => a.active);
                if (activeAgents.length === 0) return;

                const agent = activeAgents[this.utils.randomInt(0, activeAgents.length - 1)];
                const isBuy = Math.random() > 0.3;
                const fund = this.fundNames[this.utils.randomInt(0, this.fundNames.length - 1)];
                const amount = this.utils.randomInt(5, 50) * 1000;

                const transaction = {
                    id: Date.now(),
                    name: fund,
                    type: isBuy ? 'buy' : 'sell',
                    source: 'Agent',
                    amount: amount,
                    time: this.utils.formatTime()
                };

                this.state.transactions.unshift(transaction);
                if (this.state.transactions.length > 10) this.state.transactions.pop();

                this.renderTransactions();
                this.addNotification(`${agent.name}: ${fund} ${isBuy ? 'alım' : 'satım'} - ${this.utils.formatCurrency(amount)}`);

                // Update portfolio
                this.state.portfolio.dailyChange += isBuy ? amount * 0.01 : -amount * 0.005;
                this.updatePortfolioDisplay();
            },

            renderTransactions: function() {
                const container = document.querySelector('#transactions-list');
                if (!container) return;

                container.innerHTML = this.state.transactions.slice(0, 3).map(tx => `
                    <div class="px-6 py-4 flex items-center justify-between hover:bg-neutral-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-xl flex items-center justify-center" style="background-color: ${tx.type === 'buy' ? '#E8FF5A' : '#FEE2E2'}; border: 2px solid #000000;">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="${tx.type === 'buy' ? '#171717' : '#EF4444'}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                    ${tx.type === 'buy' ? '<path d="M7 7h10v10"></path><path d="M7 17 17 7"></path>' : '<path d="m7 7 10 10"></path><path d="M17 7v10H7"></path>'}
                                </svg>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-neutral-900 font-sans">${tx.name}</p>
                                <p class="text-xs text-neutral-500 font-sans">${tx.type === 'buy' ? 'Alım' : 'Satım'} • ${tx.source}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium ${tx.type === 'buy' ? 'text-emerald-600' : 'text-red-500'} font-sans">${tx.type === 'buy' ? '+' : '-'}₺${tx.amount.toLocaleString('tr-TR')}</p>
                            <p class="text-xs text-neutral-400 font-sans">${tx.time}</p>
                        </div>
                    </div>
                `).join('');
            },

            updatePortfolioDisplay: function() {
                const dailyEl = document.querySelector('#daily-performance');
                if (dailyEl) {
                    dailyEl.textContent = '+' + this.utils.formatCurrency(this.state.portfolio.dailyChange);
                }
            },

            // Notifications
            initNotifications: function() {
                const bellBtn = document.querySelector('#notification-bell');
                if (bellBtn) {
                    bellBtn.addEventListener('click', () => this.toggleNotificationPanel());
                }
            },

            addNotification: function(text) {
                this.state.notifications.unshift({
                    id: Date.now(),
                    text: text,
                    time: this.utils.formatTime(),
                    read: false
                });
                this.updateNotificationBadge();
            },

            updateNotificationBadge: function() {
                const badge = document.querySelector('#notification-badge');
                const unread = this.state.notifications.filter(n => !n.read).length;
                if (badge) {
                    badge.style.display = unread > 0 ? 'flex' : 'none';
                    var span = badge.querySelector('span');
                    if (span) span.textContent = unread > 9 ? '9+' : unread;
                }
            },

            toggleNotificationPanel: function() {
                let panel = document.querySelector('#notification-panel');
                if (panel) {
                    panel.remove();
                    return;
                }

                const html = `
                    <div id="notification-panel" class="absolute top-12 right-0 w-80 bg-white rounded-xl shadow-xl z-50" style="border: 2px solid #000000;">
                        <div class="px-4 py-3 border-b border-neutral-200">
                            <h4 class="text-sm font-medium text-neutral-900 font-sans">Bildirimler</h4>
                        </div>
                        <div class="max-h-64 overflow-y-auto">
                            ${this.state.notifications.slice(0, 5).map(n => `
                                <div class="px-4 py-3 hover:bg-neutral-50 border-b border-neutral-100 ${n.read ? '' : 'bg-neutral-50'}">
                                    <p class="text-sm text-neutral-700 font-sans">${n.text}</p>
                                    <p class="text-xs text-neutral-400 mt-1 font-sans">${n.time}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;

                document.querySelector('#notification-bell').parentElement.style.position = 'relative';
                document.querySelector('#notification-bell').parentElement.insertAdjacentHTML('beforeend', html);

                this.state.notifications.forEach(n => n.read = true);
                this.updateNotificationBadge();
            },

            // Navigation
            initNavigation: function() {
                const self = this;
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        const page = this.dataset.page || this.closest('[data-page]')?.dataset.page;
                        if (page) {
                            self.navigateTo(page);
                        }
                    });
                });
            },

            navigateTo: function(page) {
                if (!page) return;

                // Update nav links
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('bg-neutral-100', 'text-neutral-900', 'font-medium');
                    link.classList.add('text-neutral-500');
                });
                const activeLink = document.querySelector(`[data-page="${page}"]`);
                if (activeLink) {
                    activeLink.classList.add('bg-neutral-100', 'text-neutral-900', 'font-medium');
                    activeLink.classList.remove('text-neutral-500');
                }

                // Show/hide page content
                const pageMap = { dashboard: 'page-dashboard', portfolio: 'page-portfolio', funds: 'page-funds', history: 'page-history' };
                document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
                const targetPage = document.getElementById(pageMap[page]);
                if (targetPage) {
                    targetPage.classList.remove('hidden');
                    targetPage.classList.remove('page-fade-in');
                    void targetPage.offsetWidth;
                    targetPage.classList.add('page-fade-in');
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }

                this.state.currentPage = page;
            },

            // Interactive Chart
            initInteractiveChart: function() {
                const canvas = document.getElementById('portfolio-chart');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                const container = canvas.parentElement;
                const tooltip = document.getElementById('chart-tooltip');
                const crosshairV = document.getElementById('chart-crosshair-v');
                const crosshairH = document.getElementById('chart-crosshair-h');
                const hoverPoint = document.getElementById('chart-hover-point');

                // Chart data
                this.chartData = {
                    '1G': this.generateChartData(24, 2840000, 0.002),
                    '1H': this.generateChartData(7, 2840000, 0.015),
                    '1A': this.generateChartData(30, 2840000, 0.03),
                    '6A': this.generateChartData(180, 2840000, 0.12),
                    '1Y': this.generateChartData(365, 2840000, 0.25),
                    'MAX': this.generateChartData(730, 2840000, 0.45)
                };
                this.currentPeriod = '1H';

                const self = this;

                const drawChart = () => {
                    const rect = container.getBoundingClientRect();

                    // Retina display support
                    const dpr = window.devicePixelRatio || 1;
                    canvas.width = rect.width * dpr;
                    canvas.height = rect.height * dpr;
                    canvas.style.width = rect.width + 'px';
                    canvas.style.height = rect.height + 'px';

                    // Reset transform before scaling
                    ctx.setTransform(1, 0, 0, 1, 0, 0);
                    ctx.scale(dpr, dpr);

                    // Enable anti-aliasing
                    ctx.imageSmoothingEnabled = true;
                    ctx.imageSmoothingQuality = 'high';

                    const width = rect.width;
                    const height = rect.height;

                    const data = self.chartData[self.currentPeriod];
                    const padding = { top: 40, right: 30, bottom: 50, left: 80 };
                    const chartWidth = width - padding.left - padding.right;
                    const chartHeight = height - padding.top - padding.bottom;

                    const minVal = Math.min(...data.map(d => d.value)) * 0.97;
                    const maxVal = Math.max(...data.map(d => d.value)) * 1.03;

                    ctx.clearRect(0, 0, width, height);

                    // Background gradient
                    const bgGradient = ctx.createLinearGradient(0, 0, 0, height);
                    bgGradient.addColorStop(0, '#FFFFFF');
                    bgGradient.addColorStop(1, '#FAFAFA');
                    ctx.fillStyle = bgGradient;
                    ctx.fillRect(0, 0, width, height);

                    // Horizontal grid lines with dashed style
                    ctx.setLineDash([5, 5]);
                    ctx.strokeStyle = '#E5E5E5';
                    ctx.lineWidth = 1;
                    for (let i = 0; i <= 5; i++) {
                        const y = padding.top + (chartHeight / 5) * i;
                        ctx.beginPath();
                        ctx.moveTo(padding.left, y);
                        ctx.lineTo(width - padding.right, y);
                        ctx.stroke();
                    }
                    ctx.setLineDash([]);

                    // Y-axis labels with background
                    ctx.font = '700 12px Inter, system-ui, sans-serif';
                    ctx.textAlign = 'right';
                    ctx.textBaseline = 'middle';
                    for (let i = 0; i <= 5; i++) {
                        const y = padding.top + (chartHeight / 5) * i;
                        const value = maxVal - ((maxVal - minVal) / 5) * i;
                        const label = '₺' + (value / 1000000).toFixed(2) + 'M';

                        // Label background
                        const textWidth = ctx.measureText(label).width;
                        ctx.fillStyle = '#F5F5F5';
                        ctx.fillRect(padding.left - textWidth - 18, y - 10, textWidth + 12, 20);
                        ctx.strokeStyle = '#E5E5E5';
                        ctx.lineWidth = 1;
                        ctx.strokeRect(padding.left - textWidth - 18, y - 10, textWidth + 12, 20);

                        ctx.fillStyle = '#525252';
                        ctx.fillText(label, padding.left - 12, y);
                    }

                    // X-axis labels
                    ctx.font = '600 11px Inter, system-ui, sans-serif';
                    ctx.fillStyle = '#737373';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'top';
                    const xLabelCount = Math.min(6, data.length);
                    for (let i = 0; i < xLabelCount; i++) {
                        const idx = Math.floor(i * (data.length - 1) / (xLabelCount - 1));
                        const x = padding.left + (idx / (data.length - 1)) * chartWidth;
                        const point = data[idx];
                        ctx.fillText(point.date.split(' ')[0], x, height - padding.bottom + 15);
                    }

                    // Main gradient fill
                    const gradient = ctx.createLinearGradient(0, padding.top, 0, height - padding.bottom);
                    gradient.addColorStop(0, 'rgba(232, 255, 90, 0.5)');
                    gradient.addColorStop(0.4, 'rgba(232, 255, 90, 0.25)');
                    gradient.addColorStop(0.8, 'rgba(232, 255, 90, 0.08)');
                    gradient.addColorStop(1, 'rgba(232, 255, 90, 0)');

                    // Draw area fill
                    ctx.beginPath();
                    data.forEach((point, i) => {
                        const x = padding.left + (i / (data.length - 1)) * chartWidth;
                        const y = padding.top + ((maxVal - point.value) / (maxVal - minVal)) * chartHeight;
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    });
                    ctx.lineTo(padding.left + chartWidth, height - padding.bottom);
                    ctx.lineTo(padding.left, height - padding.bottom);
                    ctx.closePath();
                    ctx.fillStyle = gradient;
                    ctx.fill();

                    // Draw shadow line
                    ctx.beginPath();
                    ctx.strokeStyle = 'rgba(0, 0, 0, 0.1)';
                    ctx.lineWidth = 6;
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';
                    data.forEach((point, i) => {
                        const x = padding.left + (i / (data.length - 1)) * chartWidth;
                        const y = padding.top + ((maxVal - point.value) / (maxVal - minVal)) * chartHeight + 3;
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    });
                    ctx.stroke();

                    // Draw main line
                    ctx.beginPath();
                    ctx.strokeStyle = '#171717';
                    ctx.lineWidth = 4;
                    ctx.lineCap = 'round';
                    ctx.lineJoin = 'round';
                    data.forEach((point, i) => {
                        const x = padding.left + (i / (data.length - 1)) * chartWidth;
                        const y = padding.top + ((maxVal - point.value) / (maxVal - minVal)) * chartHeight;
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    });
                    ctx.stroke();

                    // Draw accent line on top
                    ctx.beginPath();
                    ctx.strokeStyle = '#E8FF5A';
                    ctx.lineWidth = 2;
                    data.forEach((point, i) => {
                        const x = padding.left + (i / (data.length - 1)) * chartWidth;
                        const y = padding.top + ((maxVal - point.value) / (maxVal - minVal)) * chartHeight - 2;
                        if (i === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    });
                    ctx.stroke();

                    // Draw start and end points
                    const startX = padding.left;
                    const startY = padding.top + ((maxVal - data[0].value) / (maxVal - minVal)) * chartHeight;
                    const endX = padding.left + chartWidth;
                    const endY = padding.top + ((maxVal - data[data.length - 1].value) / (maxVal - minVal)) * chartHeight;

                    // Start point
                    ctx.beginPath();
                    ctx.arc(startX, startY, 6, 0, Math.PI * 2);
                    ctx.fillStyle = '#171717';
                    ctx.fill();
                    ctx.beginPath();
                    ctx.arc(startX, startY, 3, 0, Math.PI * 2);
                    ctx.fillStyle = '#E8FF5A';
                    ctx.fill();

                    // End point (current value)
                    ctx.beginPath();
                    ctx.arc(endX, endY, 8, 0, Math.PI * 2);
                    ctx.fillStyle = '#E8FF5A';
                    ctx.fill();
                    ctx.strokeStyle = '#171717';
                    ctx.lineWidth = 3;
                    ctx.stroke();
                    ctx.beginPath();
                    ctx.arc(endX, endY, 4, 0, Math.PI * 2);
                    ctx.fillStyle = '#171717';
                    ctx.fill();

                    // Store for hover
                    self.chartMeta = { data, padding, chartWidth, chartHeight, minVal, maxVal, width, height };

                    // Update last update time
                    const updateEl = document.getElementById('chart-last-update');
                    if (updateEl) updateEl.textContent = self.utils.formatTime();
                };

                // Mouse events
                canvas.addEventListener('mousemove', (e) => {
                    if (!self.chartMeta) return;
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const { data, padding, chartWidth, chartHeight, minVal, maxVal, width, height } = self.chartMeta;

                    if (x < padding.left || x > width - padding.right) {
                        tooltip.classList.add('hidden');
                        crosshairV.classList.add('hidden');
                        crosshairH.classList.add('hidden');
                        if (hoverPoint) hoverPoint.classList.add('hidden');
                        return;
                    }

                    const idx = Math.round(((x - padding.left) / chartWidth) * (data.length - 1));
                    const clampedIdx = Math.max(0, Math.min(idx, data.length - 1));
                    const point = data[clampedIdx];
                    const pointX = padding.left + (clampedIdx / (data.length - 1)) * chartWidth;
                    const pointY = padding.top + ((maxVal - point.value) / (maxVal - minVal)) * chartHeight;

                    // Show hover point indicator
                    if (hoverPoint) {
                        hoverPoint.style.left = `${pointX}px`;
                        hoverPoint.style.top = `${pointY}px`;
                        hoverPoint.classList.remove('hidden');
                    }

                    // Crosshairs
                    crosshairV.style.left = `${pointX}px`;
                    crosshairH.style.top = `${pointY}px`;
                    crosshairV.classList.remove('hidden');
                    crosshairH.classList.remove('hidden');

                    // Tooltip positioning
                    const tooltipX = pointX + 20;
                    const tooltipY = Math.max(pointY - 60, 20);
                    tooltip.style.left = `${Math.min(tooltipX, width - 180)}px`;
                    tooltip.style.top = `${tooltipY}px`;

                    document.getElementById('tooltip-date').textContent = point.date;
                    document.getElementById('tooltip-value').textContent = '₺' + self.formatNumber(point.value);
                    const change = ((point.value - data[0].value) / data[0].value * 100).toFixed(2);
                    const changeEl = document.getElementById('tooltip-change');
                    changeEl.textContent = (change >= 0 ? '+' : '') + change + '%';
                    changeEl.style.color = change >= 0 ? '#E8FF5A' : '#F87171';
                    tooltip.classList.remove('hidden');
                });

                canvas.addEventListener('mouseleave', () => {
                    tooltip.classList.add('hidden');
                    crosshairV.classList.add('hidden');
                    crosshairH.classList.add('hidden');
                    if (hoverPoint) hoverPoint.classList.add('hidden');
                });

                // Period buttons
                document.querySelectorAll('.chart-period-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.chart-period-btn').forEach(b => {
                            b.style.backgroundColor = '';
                            b.classList.remove('text-neutral-900');
                            b.classList.add('text-neutral-500');
                        });
                        btn.style.backgroundColor = '#E8FF5A';
                        btn.classList.add('text-neutral-900');
                        btn.classList.remove('text-neutral-500');
                        self.currentPeriod = btn.dataset.period;
                        drawChart();
                        self.updateChartStats();
                    });
                });

                drawChart();
                this.updateChartStats();
                window.addEventListener('resize', drawChart);
            },

            generateChartData: function(points, baseValue, volatility) {
                const data = [];
                let value = baseValue * (1 - volatility * 0.5);
                const now = new Date();
                for (let i = 0; i < points; i++) {
                    const date = new Date(now);
                    date.setDate(date.getDate() - (points - i));
                    value += (Math.random() - 0.45) * baseValue * (volatility / points) * 2;
                    value = Math.max(value, baseValue * 0.5);
                    data.push({ date: date.toLocaleDateString('tr-TR'), value });
                }
                data[data.length - 1].value = baseValue;
                return data;
            },

            updateChartStats: function() {
                const data = this.chartData[this.currentPeriod];
                const values = data.map(d => d.value);
                const high = Math.max(...values);
                const low = Math.min(...values);
                const avg = values.reduce((a, b) => a + b, 0) / values.length;
                const currentValue = data[data.length - 1].value;
                const startValue = data[0].value;
                const changeAmount = currentValue - startValue;
                const changePercent = ((changeAmount) / startValue * 100).toFixed(1);
                const volume = Math.floor(Math.random() * 500000 + 500000);

                document.getElementById('chart-high').textContent = '₺' + this.formatNumber(high);
                document.getElementById('chart-low').textContent = '₺' + this.formatNumber(low);
                document.getElementById('chart-avg').textContent = '₺' + this.formatNumber(avg);
                document.getElementById('chart-volume').textContent = '₺' + this.formatNumber(volume);
                document.getElementById('chart-current-value').textContent = '₺' + this.formatNumber(currentValue);
                document.getElementById('chart-change-badge').textContent = (changePercent >= 0 ? '+' : '') + changePercent + '%';

                const changeAmountEl = document.getElementById('chart-change-amount');
                if (changeAmountEl) {
                    changeAmountEl.textContent = (changeAmount >= 0 ? '+' : '') + '₺' + this.formatNumber(Math.abs(changeAmount));
                    changeAmountEl.className = 'text-sm font-medium font-sans ' + (changeAmount >= 0 ? 'text-emerald-600' : 'text-red-500');
                }
            },

            // Watchlist
            initWatchlist: function() {
                document.querySelectorAll('.watchlist-item').forEach(item => {
                    item.addEventListener('click', () => {
                        const symbol = item.dataset.symbol;
                        const stock = this.state.watchlist.find(s => s.symbol === symbol);
                        if (stock) this.openTradeModal(stock.symbol, stock.price);
                    });
                });
                document.querySelector('#add-watchlist-btn')?.addEventListener('click', () => {
                    this.showToast('Yeni hisse ekleme özelliği yakında aktif olacak', 'info');
                });
                document.querySelectorAll('.watchlist-item').forEach(item => {
                    item.addEventListener('click', () => {
                        var sym = item.dataset.symbol;
                        var stock = this.state.watchlist.find(s => s.symbol === sym);
                        if (stock) this.openTradeModal(sym, stock.price);
                    });
                });
                setInterval(() => this.updateWatchlistPrices(), 4000);
            },

            updateWatchlistPrices: function() {
                this.state.watchlist.forEach(stock => {
                    const changeAmount = this.utils.randomInRange(-0.5, 0.8);
                    stock.price = Math.max(1, stock.price * (1 + changeAmount / 100));
                    stock.change = this.utils.randomInRange(-2, 3);
                });
                this.renderWatchlist();
            },

            renderWatchlist: function() {
                const container = document.querySelector('#watchlist-container');
                if (!container) return;
                container.innerHTML = this.state.watchlist.map((stock, i) => `
                    <div class="watchlist-item flex items-center justify-between p-3 bg-neutral-50 rounded-xl hover:bg-neutral-100 transition-colors cursor-pointer" style="border: 2px solid #000000;" data-symbol="${stock.symbol}">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 ${i % 2 === 0 ? 'bg-neutral-900' : ''} rounded-lg flex items-center justify-center" style="${i % 2 === 0 ? 'border: 2px solid #000000;' : 'background-color: #E8FF5A; border: 2px solid #000000;'}">
                                <span class="${i % 2 === 0 ? 'text-white' : 'text-neutral-900'} text-xs font-bold">${stock.symbol.substring(0, 2)}</span>
                            </div>
                            <div>
                                <p class="text-xs font-medium text-neutral-900 font-sans">${stock.symbol}</p>
                                <p class="text-xs text-neutral-500 font-sans">${stock.name}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-sm font-medium text-neutral-900 font-sans">₺${stock.price.toFixed(2)}</p>
                            <p class="text-xs ${stock.change >= 0 ? 'text-emerald-600' : 'text-red-500'} font-medium font-sans">${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)}%</p>
                        </div>
                    </div>
                `).join('');
                this.initWatchlist();
            },

            // Trade Modal
            initTradeModal: function() {
                var modalInner = document.querySelector('#trade-modal .bg-white');
                if (modalInner) this._tradeModalOriginalHTML = modalInner.innerHTML;
                this._bindTradeModalEvents();
            },

            openTradeModal: function(symbol, price) {
                const modal = document.querySelector('#trade-modal');
                if (!modal) return;

                this.state.tradeModal = { isOpen: true, symbol, price, type: 'buy', amount: 10000 };

                document.querySelector('#trade-modal-symbol').textContent = symbol;
                document.querySelector('#trade-modal-symbol-icon').textContent = symbol.substring(0, 2);
                document.querySelector('#trade-modal-price').textContent = `Güncel Fiyat: ₺${price.toFixed(2)}`;
                document.querySelector('#trade-amount').value = 10000;
                this.setTradeType('buy');
                this.updateEstimatedShares();

                modal.classList.remove('hidden');
            },

            closeTradeModal: function() {
                var modal = document.querySelector('#trade-modal');
                if (modal) modal.classList.add('hidden');
                this.state.tradeModal.isOpen = false;
                // Restore original modal content if it was replaced by success animation
                var modalInner = document.querySelector('#trade-modal .bg-white');
                if (modalInner && this._tradeModalOriginalHTML && !document.querySelector('#trade-modal-close')) {
                    modalInner.innerHTML = this._tradeModalOriginalHTML;
                    this._bindTradeModalEvents();
                }
            },

            _bindTradeModalEvents: function() {
                document.querySelector('#trade-modal-close')?.addEventListener('click', () => this.closeTradeModal());
                document.querySelector('#trade-modal-overlay')?.addEventListener('click', () => this.closeTradeModal());
                document.querySelector('#trade-type-buy')?.addEventListener('click', () => this.setTradeType('buy'));
                document.querySelector('#trade-type-sell')?.addEventListener('click', () => this.setTradeType('sell'));
                document.querySelectorAll('.trade-preset-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const amount = parseInt(btn.dataset.amount);
                        document.querySelector('#trade-amount').value = amount;
                        this.state.tradeModal.amount = amount;
                        this.updateEstimatedShares();
                    });
                });
                document.querySelector('#trade-amount')?.addEventListener('input', (e) => {
                    this.state.tradeModal.amount = parseInt(e.target.value) || 0;
                    this.updateEstimatedShares();
                });
                document.querySelector('#trade-confirm-btn')?.addEventListener('click', () => this.confirmTrade());
            },

            setTradeType: function(type) {
                this.state.tradeModal.type = type;
                const buyBtn = document.querySelector('#trade-type-buy');
                const sellBtn = document.querySelector('#trade-type-sell');

                if (type === 'buy') {
                    buyBtn.style.backgroundColor = '#E8FF5A';
                    buyBtn.classList.remove('bg-neutral-100', 'text-neutral-700');
                    sellBtn.style.backgroundColor = '';
                    sellBtn.classList.add('bg-neutral-100', 'text-neutral-700');
                } else {
                    sellBtn.style.backgroundColor = '#EF4444';
                    sellBtn.classList.remove('bg-neutral-100', 'text-neutral-700');
                    sellBtn.classList.add('text-white');
                    buyBtn.style.backgroundColor = '';
                    buyBtn.classList.add('bg-neutral-100', 'text-neutral-700');
                }
            },

            updateEstimatedShares: function() {
                const { amount, price } = this.state.tradeModal;
                const shares = price > 0 ? (amount / price).toFixed(1) : 0;
                document.querySelector('#trade-estimated-shares').textContent = `~${shares} adet`;
            },

            confirmTrade: function() {
                const { symbol, amount, type } = this.state.tradeModal;
                const tx = {
                    id: Date.now(),
                    name: symbol,
                    type: type,
                    source: 'Manuel',
                    amount: amount,
                    time: this.utils.formatTime()
                };
                this.state.transactions.unshift(tx);
                this.renderTransactions();
                this.addActivityLog(type === 'buy' ? 'trade-buy' : 'trade-sell', `${symbol} ${type === 'buy' ? 'alım' : 'satım'} emri gerçekleşti - ₺${amount.toLocaleString('tr-TR')}`);
                this.addNotification(`${symbol} ${type === 'buy' ? 'alım' : 'satım'} - ₺${amount.toLocaleString('tr-TR')}`);
                this.showTradeSuccess(symbol, amount, type);
            },

            showTradeSuccess: function(symbol, amount, type) {
                const modalContent = document.querySelector('#trade-modal .bg-white');
                if (!modalContent) { this.closeTradeModal(); return; }
                const label = type === 'buy' ? 'Alım' : 'Satım';
                const color = type === 'buy' ? '#059669' : '#DC2626';
                modalContent.innerHTML = `
                    <div class="flex flex-col items-center justify-center py-12 px-6">
                        <div class="relative mb-6">
                            <svg width="80" height="80" viewBox="0 0 80 80">
                                <circle cx="40" cy="40" r="36" fill="none" stroke="${color}" stroke-width="3" stroke-dasharray="226" stroke-dashoffset="0" style="animation: success-circle 0.6s ease-out forwards;" opacity="0.2"/>
                                <circle cx="40" cy="40" r="36" fill="none" stroke="${color}" stroke-width="3" stroke-dasharray="226" stroke-dashoffset="226" style="animation: success-circle 0.6s ease-out forwards;"/>
                                <path d="M24 40 L35 51 L56 30" fill="none" stroke="${color}" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="50" stroke-dashoffset="50" style="animation: success-check 0.4s 0.4s ease-out forwards;"/>
                            </svg>
                            <div style="position:absolute;inset:0;border-radius:50%;border:2px solid ${color};animation:pulse-ring 1s ease-out;opacity:0;"></div>
                        </div>
                        <h3 class="text-lg font-semibold text-neutral-900 font-sans mb-1">İşlem Başarılı</h3>
                        <p class="text-sm text-neutral-500 font-sans mb-4">${symbol} ${label} emri gerçekleştirildi</p>
                        <div class="w-full p-4 rounded-xl mb-6" style="background-color: ${type === 'buy' ? '#F0FDF4' : '#FEF2F2'}; border: 2px solid ${color}20;">
                            <div class="flex justify-between text-sm mb-2">
                                <span class="text-neutral-500 font-sans">Tutar</span>
                                <span class="font-semibold text-neutral-900 font-sans">₺${amount.toLocaleString('tr-TR')}</span>
                            </div>
                            <div class="flex justify-between text-sm mb-2">
                                <span class="text-neutral-500 font-sans">İşlem</span>
                                <span class="font-semibold font-sans" style="color:${color}">${label}</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span class="text-neutral-500 font-sans">Saat</span>
                                <span class="font-semibold text-neutral-900 font-sans">${this.utils.formatTime()}</span>
                            </div>
                        </div>
                        <button onclick="NurolApp.closeTradeModal()" class="w-full py-3 text-sm font-medium rounded-xl transition-colors hover:opacity-90" style="background-color: #E8FF5A; border: 2px solid #000000;">Tamam</button>
                    </div>`;
                this.showToast(`${symbol} ${label} - ₺${amount.toLocaleString('tr-TR')}`, type === 'buy' ? 'success' : 'info');
            },

            // AI Recommendations
            initAIRecommendations: function() {
                // Trade buttons
                document.querySelectorAll('.trade-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const symbol = btn.dataset.symbol;
                        const action = btn.dataset.action;
                        const stock = this.state.watchlist.find(s => s.symbol === symbol) || { price: 100 };
                        this.openTradeModal(symbol, stock.price);
                        if (action === 'sell') this.setTradeType('sell');
                    });
                });

                // Signal filter tabs
                const self = this;
                document.querySelectorAll('.signal-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.signal-tab').forEach(t => {
                            t.style.backgroundColor = '';
                            t.classList.add('text-neutral-500');
                        });
                        tab.style.backgroundColor = '#E8FF5A';
                        tab.classList.remove('text-neutral-500');

                        const filter = tab.dataset.filter;
                        document.querySelectorAll('.signal-card').forEach(card => {
                            if (filter === 'all' || card.dataset.type === filter) {
                                card.style.display = 'block';
                            } else {
                                card.style.display = 'none';
                            }
                        });
                    });
                });
            },

            // Top Movers (Gainers/Losers)
            initTopMovers: function() {
                document.querySelector('#gainers-tab')?.addEventListener('click', () => this.switchMoverTab('gainers'));
                document.querySelector('#losers-tab')?.addEventListener('click', () => this.switchMoverTab('losers'));
            },

            switchMoverTab: function(tab) {
                const gainersTab = document.querySelector('#gainers-tab');
                const losersTab = document.querySelector('#losers-tab');
                const gainersList = document.querySelector('#gainers-list');
                const losersList = document.querySelector('#losers-list');

                if (tab === 'gainers') {
                    gainersTab.classList.add('bg-neutral-900', 'text-white');
                    gainersTab.classList.remove('text-neutral-500');
                    losersTab.classList.remove('bg-neutral-900', 'text-white');
                    losersTab.classList.add('text-neutral-500');
                    gainersList.classList.remove('hidden');
                    losersList.classList.add('hidden');
                } else {
                    losersTab.classList.add('bg-neutral-900', 'text-white');
                    losersTab.classList.remove('text-neutral-500');
                    gainersTab.classList.remove('bg-neutral-900', 'text-white');
                    gainersTab.classList.add('text-neutral-500');
                    losersList.classList.remove('hidden');
                    gainersList.classList.add('hidden');
                }
            },

            // Activity Log
            initActivityLog: function() {
                document.querySelector('#agent-log-filter')?.addEventListener('change', (e) => {
                    this.filterActivityLog(e.target.value);
                });
            },

            filterActivityLog: function(filter) {
                const entries = document.querySelectorAll('#agent-activity-log .log-entry');
                entries.forEach(entry => {
                    if (filter === 'all') {
                        entry.style.display = 'flex';
                    } else {
                        const entryType = entry.dataset.type;
                        const show = entryType === filter;
                        entry.style.display = show ? 'flex' : 'none';
                    }
                });
            },

            addActivityLog: function(type, message) {
                const container = document.querySelector('#agent-activity-log');
                if (!container) return;

                const styles = {
                    'trade-buy': { iconBg: '#E8FF5A', iconStroke: '#171717', badge: 'ALIM', badgeBg: '#E8FF5A', badgeText: '', iconSvg: '<path d="M7 7h10v10"></path><path d="M7 17 17 7"></path>', dataType: 'trade' },
                    'trade-sell': { iconBg: '#171717', iconStroke: 'white', badge: 'SATIM', badgeBg: '#171717', badgeText: 'text-white', iconSvg: '<path d="m7 7 10 10"></path><path d="M17 7v10H7"></path>', dataType: 'trade' },
                    'analysis': { iconBg: '#171717', iconStroke: 'white', badge: 'ANALİZ', badgeBg: '#E5E5E5', badgeText: 'text-neutral-700', iconSvg: '<circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path>', dataType: 'analysis' },
                    'alert': { iconBg: '#E8FF5A', iconStroke: '#171717', badge: 'UYARI', badgeBg: '#171717', badgeText: 'text-white', iconSvg: '<path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>', dataType: 'alert' }
                };
                const s = styles[type] || styles['analysis'];

                const html = `
                    <div class="log-entry flex items-start gap-3 p-3 bg-neutral-50 rounded-xl" data-type="${s.dataType}" style="border: 2px solid #000000;">
                        <div class="w-7 h-7 rounded-lg flex items-center justify-center flex-shrink-0" style="background-color: ${s.iconBg}; border: 2px solid #000000;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="${s.iconStroke}" stroke-width="2.5">${s.iconSvg}</svg>
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-semibold text-neutral-900 font-sans">${type.includes('trade') ? 'Trend Takipçi' : 'Sistem'}</span>
                                <span class="text-xs text-neutral-500 font-sans font-medium">${this.utils.formatTime()}</span>
                            </div>
                            <p class="text-xs text-neutral-600 font-sans mt-1">${message}</p>
                            <span class="inline-block mt-1.5 text-xs px-2 py-0.5 rounded-full font-medium ${s.badgeText}" style="background-color: ${s.badgeBg}; border: 1px solid #000000;">${s.badge}</span>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('afterbegin', html);
            },

            // Risk Meter
            initRiskMeter: function() {
                this.updateRiskMeter();
                setInterval(() => {
                    this.state.riskScore = Math.max(10, Math.min(90, this.state.riskScore + this.utils.randomInt(-8, 8)));
                    this.updateRiskMeter();
                }, 6000);
            },

            updateRiskMeter: function() {
                const needleGroup = document.querySelector('#risk-needle-group');
                const levelText = document.querySelector('#risk-level-text');
                const scoreText = document.querySelector('#risk-score');
                const levelBadge = document.querySelector('#risk-level-badge');
                const levelIcon = document.querySelector('#risk-level-icon');
                const updateTime = document.querySelector('#risk-update-time');

                if (!needleGroup) return;

                const score = this.state.riskScore;
                const angle = -90 + (score / 100) * 180;

                // Animate needle with CSS transform
                needleGroup.style.transform = `rotate(${angle}deg)`;

                // Determine risk level and styling
                let level, badgeBg, iconSvg;
                if (score < 30) {
                    level = 'DÜŞÜK';
                    badgeBg = '#E8FF5A';
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#E8FF5A" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>';
                } else if (score < 60) {
                    level = 'ORTA';
                    badgeBg = '#FDE047';
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#FDE047" stroke-width="3"><line x1="5" y1="12" x2="19" y2="12"/></svg>';
                } else {
                    level = 'YÜKSEK';
                    badgeBg = '#FCA5A5';
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="#FCA5A5" stroke-width="3"><path d="M12 9v4"/><path d="M12 17h.01"/></svg>';
                }

                if (levelText) levelText.textContent = level;
                if (levelBadge) levelBadge.style.backgroundColor = badgeBg;
                if (levelIcon) levelIcon.innerHTML = iconSvg;
                if (scoreText) scoreText.innerHTML = `Risk Skoru: <span class="font-bold text-neutral-900">${score}</span>/100`;
                if (updateTime) updateTime.textContent = this.utils.formatTime();

                // Update metrics with animations
                this.updateRiskMetrics(score);
            },

            updateRiskMetrics: function(score) {
                // Calculate dynamic metrics based on score
                const volatility = (8 + (score / 100) * 20).toFixed(1);
                const sharpe = (2.0 - (score / 100) * 1.2).toFixed(2);
                const drawdown = (-3 - (score / 100) * 15).toFixed(1);
                const beta = (0.5 + (score / 100) * 0.8).toFixed(2);

                // Update values
                const volEl = document.querySelector('#risk-volatility');
                const sharpeEl = document.querySelector('#risk-sharpe');
                const drawdownEl = document.querySelector('#risk-drawdown');
                const betaEl = document.querySelector('#risk-beta');

                if (volEl) volEl.textContent = volatility + '%';
                if (sharpeEl) sharpeEl.textContent = sharpe;
                if (drawdownEl) drawdownEl.textContent = drawdown + '%';
                if (betaEl) betaEl.textContent = beta;

                // Update progress bars with animation
                const volBar = document.querySelector('#risk-volatility-bar');
                const sharpeBar = document.querySelector('#risk-sharpe-bar');
                const drawdownBar = document.querySelector('#risk-drawdown-bar');
                const betaBar = document.querySelector('#risk-beta-bar');

                if (volBar) volBar.style.width = Math.min(volatility * 3, 100) + '%';
                if (sharpeBar) sharpeBar.style.width = Math.min(sharpe * 40, 100) + '%';
                if (drawdownBar) drawdownBar.style.width = Math.min(Math.abs(drawdown) * 5, 100) + '%';
                if (betaBar) betaBar.style.width = Math.min(beta * 60, 100) + '%';

                // Update bar colors based on values
                if (volBar) {
                    volBar.style.background = parseFloat(volatility) < 15
                        ? 'linear-gradient(90deg, #22C55E, #E8FF5A)'
                        : parseFloat(volatility) < 22
                            ? 'linear-gradient(90deg, #E8FF5A, #EAB308)'
                            : 'linear-gradient(90deg, #EAB308, #EF4444)';
                }
            },

            // Twitter Feed
            initTwitterFeed: function() {
                const mockTweets = [
                    { user: 'Reuters TR', handle: 'RT', content: '🔥 BIST 100 endeksi gün içi zirve yaptı! 9,850 puan test edildi. Yabancı alımları ivme kazandı. #Borsa #BIST100', sentiment: 'Pozitif', time: '1dk' },
                    { user: 'Ekonomist', handle: 'EK', content: '📊 Enflasyon verileri açıklandı. TCMB hedeflerinin üzerinde seyrediyor. Piyasalar temkinli. #Ekonomi', sentiment: 'Nötr', time: '5dk' },
                    { user: 'Yatırım Pro', handle: 'YP', content: '💎 #ASELS savunma ihalelerinden güçlü haberler. Uzun vadeli alım fırsatı olabilir. Teknik göstergeler pozitif.', sentiment: 'Pozitif', time: '18dk' },
                    { user: 'Döviz Takip', handle: 'DT', content: '⚠️ Altın ons fiyatı $2,400 üzerine çıktı. Küresel belirsizlikler güvenli liman talebini artırıyor. #Altın #Gold', sentiment: 'Nötr', time: '32dk' },
                    { user: 'Borsa Uzmanı', handle: 'BU', content: '🔴 #SISE hissesinde satış baskısı. Destek seviyesi 48.00 TL. Kırılırsa 44.50 hedef. Dikkatli olun!', sentiment: 'Negatif', time: '45dk' }
                ];

                const self = this;
                setInterval(() => {
                    const tweet = mockTweets[Math.floor(Math.random() * mockTweets.length)];
                    self.addTweet(tweet);
                }, 15000);
            },

            addTweet: function(tweet) {
                const container = document.querySelector('#twitter-feed');
                if (!container) return;

                const sentimentClass = tweet.sentiment === 'Pozitif' ? 'bg-emerald-100 text-emerald-700' :
                                       tweet.sentiment === 'Negatif' ? 'bg-red-100 text-red-700' : 'bg-yellow-100 text-yellow-700';
                const bgColor = Math.random() > 0.5 ? 'background-color: #E8FF5A;' : 'background-color: #171717;';
                const textColor = bgColor.includes('E8FF5A') ? 'text-neutral-900' : 'text-white';

                const html = `
                    <div class="tweet-item p-3 rounded-xl transition-colors hover:bg-neutral-50 animate-pulse" style="border: 2px solid #000000; animation: fadeIn 0.5s ease-out;">
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 rounded-full flex-shrink-0 flex items-center justify-center" style="${bgColor} border: 2px solid #000000;">
                                <span class="text-xs font-bold ${textColor}">${tweet.handle}</span>
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-sm font-semibold text-neutral-900 font-sans">${tweet.user}</span>
                                    <span class="text-xs text-neutral-400 font-sans">${tweet.time}</span>
                                </div>
                                <p class="text-xs text-neutral-700 font-sans leading-relaxed">${tweet.content}</p>
                                <div class="flex items-center gap-3 mt-2">
                                    <span class="text-xs px-2 py-0.5 rounded-full ${sentimentClass} font-sans">${tweet.sentiment}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('afterbegin', html);

                setTimeout(() => {
                    const newTweet = container.firstElementChild;
                    if (newTweet) newTweet.classList.remove('animate-pulse');
                }, 1000);

                while (container.children.length > 10) {
                    container.removeChild(container.lastChild);
                }
            },

            // D3.js Sektör Bazlı Stacked Horizontal Bar Chart
            initSectorStackedChart: function() {
                const self = this;
                // Delay to ensure DOM layout is computed
                setTimeout(function() { self._renderSectorChart(); }, 300);
            },

            _renderSectorChart: function() {
                try {
                const container = document.getElementById('sector-stacked-chart');
                if (!container) { console.error('Sector chart container not found'); return; }
                if (typeof d3 === 'undefined') { console.error('D3.js not loaded'); return; }

                const sectorData = [
                    { sektor: 'Teknoloji', Hisse: 420000, Fon: 180000, Tahvil: 60000 },
                    { sektor: 'Finans', Hisse: 380000, Fon: 220000, Tahvil: 140000 },
                    { sektor: 'Enerji', Hisse: 260000, Fon: 120000, Tahvil: 90000 },
                    { sektor: 'Sanayi', Hisse: 190000, Fon: 95000, Tahvil: 75000 },
                    { sektor: 'Sağlık', Hisse: 140000, Fon: 80000, Tahvil: 45000 },
                    { sektor: 'Gayrimenkul', Hisse: 110000, Fon: 60000, Tahvil: 55000 },
                    { sektor: 'Telekomünikasyon', Hisse: 85000, Fon: 45000, Tahvil: 30000 },
                    { sektor: 'Perakende', Hisse: 70000, Fon: 35000, Tahvil: 20000 }
                ];

                const keys = ['Hisse', 'Fon', 'Tahvil'];
                const colorMap = { 'Hisse': '#171717', 'Fon': '#E8FF5A', 'Tahvil': '#A3A3A3' };

                const cWidth = container.clientWidth || container.offsetWidth || 800;
                const width = Math.max(cWidth, 400);
                const marginTop = 30;
                const marginRight = 50;
                const marginBottom = 10;
                const marginLeft = 140;
                const height = sectorData.length * 40 + marginTop + marginBottom;

                const series = d3.stack().keys(keys)(sectorData);

                const x = d3.scaleLinear()
                    .domain([0, d3.max(series, s => d3.max(s, d => d[1]))])
                    .range([marginLeft, width - marginRight]);

                const y = d3.scaleBand()
                    .domain(sectorData.map(d => d.sektor))
                    .range([marginTop, height - marginBottom])
                    .padding(0.22);

                container.innerHTML = '';
                container.style.position = 'relative';

                const svg = d3.select(container)
                    .append('svg')
                    .attr('width', width)
                    .attr('height', height)
                    .attr('viewBox', '0 0 ' + width + ' ' + height)
                    .style('max-width', '100%')
                    .style('height', 'auto')
                    .style('overflow', 'visible');

                // Grid lines
                const formatVal = function(d) { return '₺' + d3.format('.2s')(d); };
                svg.append('g')
                    .attr('transform', 'translate(0,' + marginTop + ')')
                    .call(d3.axisTop(x).ticks(5).tickFormat(formatVal).tickSize(-(height - marginTop - marginBottom)))
                    .call(function(g) { g.selectAll('.domain').remove(); })
                    .call(function(g) { g.selectAll('.tick line').attr('stroke', '#E5E5E5').attr('stroke-dasharray', '3,3'); })
                    .call(function(g) { g.selectAll('.tick text').attr('fill', '#737373').attr('font-size', '11px').attr('font-family', 'Inter, sans-serif'); });

                // Bar groups
                const barGroups = svg.append('g')
                    .selectAll('g')
                    .data(series)
                    .join('g')
                    .attr('fill', function(d) { return colorMap[d.key]; });

                // Create rects (no transition first, add events, then animate)
                const rects = barGroups.selectAll('rect')
                    .data(function(D) { return D.map(function(d) { d._key = D.key; return d; }); })
                    .join('rect')
                    .attr('x', function(d) { return x(d[0]); })
                    .attr('y', function(d) { return y(d.data.sektor); })
                    .attr('height', y.bandwidth())
                    .attr('rx', 4)
                    .attr('width', 0)
                    .style('cursor', 'pointer');

                // Tooltip div
                const tooltip = d3.select(container)
                    .append('div')
                    .style('position', 'absolute')
                    .style('background', '#171717')
                    .style('color', '#fff')
                    .style('padding', '10px 14px')
                    .style('border-radius', '10px')
                    .style('font-size', '12px')
                    .style('font-family', 'Inter, sans-serif')
                    .style('pointer-events', 'none')
                    .style('opacity', '0')
                    .style('border', '2px solid #E8FF5A')
                    .style('z-index', '50')
                    .style('transition', 'opacity 0.15s');

                // Bind events BEFORE transition
                rects
                    .on('mouseover', function(event, d) {
                        d3.select(this).attr('opacity', 0.75);
                        var val = d.data[d._key];
                        tooltip.html('<div style="font-weight:600;color:#E8FF5A;margin-bottom:4px;">' + d.data.sektor + '</div><div>' + d._key + ': ₺' + val.toLocaleString('tr-TR') + '</div>')
                            .style('opacity', '1');
                    })
                    .on('mousemove', function(event) {
                        var pos = d3.pointer(event, container);
                        tooltip.style('left', (pos[0] + 15) + 'px').style('top', (pos[1] - 10) + 'px');
                    })
                    .on('mouseout', function() {
                        d3.select(this).attr('opacity', 1);
                        tooltip.style('opacity', '0');
                    });

                // Now animate
                rects.transition()
                    .duration(800)
                    .delay(function(d, i) { return i * 60; })
                    .attr('width', function(d) { return Math.max(0, x(d[1]) - x(d[0]) - 1); });

                // Value labels
                svg.append('g')
                    .selectAll('text')
                    .data(sectorData)
                    .join('text')
                    .attr('x', function(d) { return x(d.Hisse + d.Fon + d.Tahvil) + 8; })
                    .attr('y', function(d) { return y(d.sektor) + y.bandwidth() / 2; })
                    .attr('dy', '0.35em')
                    .attr('fill', '#525252')
                    .attr('font-size', '11px')
                    .attr('font-weight', '600')
                    .attr('font-family', 'Inter, sans-serif')
                    .text(function(d) { return '₺' + d3.format('.2s')(d.Hisse + d.Fon + d.Tahvil); });

                // Y axis
                svg.append('g')
                    .attr('transform', 'translate(' + marginLeft + ',0)')
                    .call(d3.axisLeft(y).tickSize(0))
                    .call(function(g) { g.selectAll('.domain').remove(); })
                    .call(function(g) {
                        g.selectAll('.tick text')
                            .attr('fill', '#171717')
                            .attr('font-size', '12px')
                            .attr('font-weight', '600')
                            .attr('font-family', 'Inter, sans-serif');
                    });

                // Legend
                var legendEl = document.getElementById('sector-chart-legend');
                if (legendEl) {
                    legendEl.innerHTML = keys.map(function(k) {
                        return '<span class="flex items-center gap-1.5"><span class="w-3 h-3 rounded" style="background:' + colorMap[k] + ';border:1px solid #000;"></span><span class="text-neutral-600 font-medium">' + k + '</span></span>';
                    }).join('');
                }

                // Time
                var timeEl = document.getElementById('sector-chart-time');
                if (timeEl) {
                    var now = new Date();
                    timeEl.textContent = now.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
                }

                console.log('Sector stacked chart rendered successfully');
                } catch(e) {
                    console.error('Sector chart error:', e);
                }
            },

            // D3.js Treemap - Varlık Dağılımı
            initTreemapChart: function() {
                var self = this;
                setTimeout(function() { self._renderTreemap(); }, 400);
            },

            _renderTreemap: function() {
                try {
                var container = document.getElementById('treemap-chart');
                if (!container) return;

                var w = container.clientWidth || container.offsetWidth || 300;
                var h = 260;

                var data = {
                    name: "Portföy",
                    children: [
                        { name: "Hisse", children: [
                            { name: "THYAO", value: 285000, change: "+2.3%" },
                            { name: "GARAN", value: 198000, change: "-0.8%" },
                            { name: "ASELS", value: 175000, change: "+1.5%" },
                            { name: "SISE", value: 142000, change: "+0.4%" },
                            { name: "KCHOL", value: 120000, change: "+1.1%" }
                        ]},
                        { name: "Fon", children: [
                            { name: "TekFon", value: 220000, change: "+3.1%" },
                            { name: "DijFon", value: 165000, change: "+2.7%" },
                            { name: "EneFon", value: 95000, change: "-0.3%" }
                        ]},
                        { name: "Tahvil", children: [
                            { name: "DİBS 2Y", value: 310000, change: "+0.2%" },
                            { name: "Eurobond", value: 185000, change: "+0.5%" }
                        ]},
                        { name: "Altın", children: [
                            { name: "Gram", value: 280000, change: "+1.8%" },
                            { name: "Çeyrek", value: 125000, change: "+1.6%" }
                        ]},
                        { name: "Diğer", children: [
                            { name: "Kripto", value: 85000, change: "+5.2%" },
                            { name: "Döviz", value: 55000, change: "-0.1%" }
                        ]}
                    ]
                };

                var colorMap = {
                    "Hisse": "#171717", "Fon": "#E8FF5A", "Tahvil": "#737373",
                    "Altın": "#525252", "Diğer": "#A3A3A3"
                };
                var textColorMap = {
                    "Hisse": "#fff", "Fon": "#171717", "Tahvil": "#fff",
                    "Altın": "#fff", "Diğer": "#171717"
                };

                container.innerHTML = '';

                var root = d3.treemap()
                    .size([w, h])
                    .padding(2)
                    .paddingTop(14)
                    .round(true)
                (d3.hierarchy(data)
                    .sum(function(d) { return d.value; })
                    .sort(function(a, b) { return b.value - a.value; }));

                var svg = d3.select(container).append("svg")
                    .attr("width", w)
                    .attr("height", h)
                    .attr("viewBox", "0 0 " + w + " " + h)
                    .style("font-family", "Inter, sans-serif");

                // Group headers
                var groups = root.children || [];
                groups.forEach(function(group) {
                    svg.append("text")
                        .attr("x", group.x0 + 3)
                        .attr("y", group.y0 + 10)
                        .text(group.data.name)
                        .attr("font-size", "9px")
                        .attr("font-weight", "600")
                        .attr("fill", "#525252");
                });

                var leaves = root.leaves();

                // Tooltip
                var tooltip = d3.select(container).append("div")
                    .style("position", "absolute")
                    .style("pointer-events", "none")
                    .style("background", "#171717")
                    .style("color", "#fff")
                    .style("padding", "6px 10px")
                    .style("border-radius", "8px")
                    .style("font-size", "11px")
                    .style("border", "1.5px solid #E8FF5A")
                    .style("opacity", 0)
                    .style("z-index", 10)
                    .style("white-space", "nowrap");

                container.style.position = "relative";

                var cells = svg.selectAll("g.cell")
                    .data(leaves)
                    .enter().append("g")
                    .attr("class", "cell")
                    .attr("transform", function(d) { return "translate(" + d.x0 + "," + d.y0 + ")"; });

                cells.append("rect")
                    .attr("width", function(d) { return Math.max(0, d.x1 - d.x0); })
                    .attr("height", 0)
                    .attr("rx", 3)
                    .attr("fill", function(d) { return colorMap[d.parent.data.name] || "#ccc"; })
                    .attr("stroke", "#fff")
                    .attr("stroke-width", 1)
                    .style("cursor", "pointer")
                    .on("mouseenter", function(event, d) {
                        d3.select(this).attr("opacity", 0.8);
                        var cat = d.parent.data.name;
                        var pct = (d.value / root.value * 100).toFixed(1);
                        tooltip.html("<strong>" + d.data.name + "</strong><br/>₺" + d.data.value.toLocaleString('tr-TR') + " · " + pct + "%<br/><span style='color:#E8FF5A'>" + (d.data.change || '') + "</span>");
                        tooltip.style("opacity", 1);
                    })
                    .on("mousemove", function(event) {
                        var rect = container.getBoundingClientRect();
                        tooltip.style("left", (event.clientX - rect.left + 10) + "px")
                               .style("top", (event.clientY - rect.top - 30) + "px");
                    })
                    .on("mouseleave", function() {
                        d3.select(this).attr("opacity", 1);
                        tooltip.style("opacity", 0);
                    })
                    .transition()
                    .duration(600)
                    .delay(function(d, i) { return i * 40; })
                    .attr("height", function(d) { return Math.max(0, d.y1 - d.y0); });

                // Labels
                cells.append("text")
                    .attr("x", 4)
                    .attr("y", 13)
                    .text(function(d) {
                        var cellW = d.x1 - d.x0;
                        return cellW > 35 ? d.data.name : '';
                    })
                    .attr("font-size", function(d) { return (d.x1 - d.x0) > 60 ? "9px" : "7px"; })
                    .attr("font-weight", "600")
                    .attr("fill", function(d) { return textColorMap[d.parent.data.name] || "#fff"; })
                    .style("pointer-events", "none")
                    .attr("opacity", 0)
                    .transition().delay(700).duration(300).attr("opacity", 1);

                // Value labels
                cells.append("text")
                    .attr("x", 4)
                    .attr("y", 24)
                    .text(function(d) {
                        var cellW = d.x1 - d.x0;
                        var cellH = d.y1 - d.y0;
                        if (cellW < 50 || cellH < 30) return '';
                        return (d.value / root.value * 100).toFixed(0) + '%';
                    })
                    .attr("font-size", "8px")
                    .attr("fill", function(d) { return textColorMap[d.parent.data.name] || "#fff"; })
                    .attr("opacity", 0.7)
                    .style("pointer-events", "none")
                    .attr("opacity", 0)
                    .transition().delay(800).duration(300).attr("opacity", 0.7);

                console.log('Treemap chart rendered successfully');
                } catch(e) {
                    console.error('Treemap chart error:', e);
                }
            },

            // D3.js Hierarchical Edge Bundling - Sektör Korelasyon Ağı
            initEdgeBundlingChart: function() {
                var self = this;
                setTimeout(function() { self._renderEdgeBundling(); }, 500);
            },

            _renderEdgeBundling: function() {
                try {
                var container = document.getElementById('edge-bundling-chart');
                if (!container) return;

                var size = Math.min(container.clientWidth || 480, container.clientHeight || 480, 480);
                var radius = size / 2;
                var innerRadius = radius * 0.65;
                var outerRadius = radius * 0.78;

                var sectors = [
                    { id: "Finans.Garanti", sector: "Finans", name: "GARAN" },
                    { id: "Finans.İşBank", sector: "Finans", name: "ISCTR" },
                    { id: "Finans.Akbank", sector: "Finans", name: "AKBNK" },
                    { id: "Finans.YKredi", sector: "Finans", name: "YKBNK" },
                    { id: "Teknoloji.Aselsan", sector: "Teknoloji", name: "ASELS" },
                    { id: "Teknoloji.Logo", sector: "Teknoloji", name: "LOGO" },
                    { id: "Teknoloji.Netaş", sector: "Teknoloji", name: "NETAS" },
                    { id: "Havacılık.THY", sector: "Havacılık", name: "THYAO" },
                    { id: "Havacılık.Pegasus", sector: "Havacılık", name: "PGSUS" },
                    { id: "Enerji.Tüpraş", sector: "Enerji", name: "TUPRS" },
                    { id: "Enerji.PetKim", sector: "Enerji", name: "PETKM" },
                    { id: "Enerji.Aygaz", sector: "Enerji", name: "AYGAZ" },
                    { id: "Sanayi.Ereğli", sector: "Sanayi", name: "EREGL" },
                    { id: "Sanayi.Koç", sector: "Sanayi", name: "KCHOL" },
                    { id: "Sanayi.Şişe", sector: "Sanayi", name: "SISE" },
                    { id: "Perakende.BİM", sector: "Perakende", name: "BIMAS" },
                    { id: "Perakende.Migros", sector: "Perakende", name: "MGROS" },
                    { id: "Telekom.Turkcell", sector: "Telekom", name: "TCELL" }
                ];

                // Correlations
                var links = [
                    ["Finans.Garanti", "Finans.İşBank", 0.92],
                    ["Finans.Garanti", "Finans.Akbank", 0.88],
                    ["Finans.İşBank", "Finans.YKredi", 0.85],
                    ["Finans.Akbank", "Finans.YKredi", 0.83],
                    ["Teknoloji.Aselsan", "Sanayi.Koç", 0.71],
                    ["Teknoloji.Aselsan", "Havacılık.THY", 0.65],
                    ["Havacılık.THY", "Havacılık.Pegasus", 0.78],
                    ["Enerji.Tüpraş", "Enerji.PetKim", 0.86],
                    ["Enerji.Tüpraş", "Enerji.Aygaz", 0.72],
                    ["Sanayi.Ereğli", "Sanayi.Şişe", 0.74],
                    ["Sanayi.Koç", "Finans.Garanti", 0.62],
                    ["Perakende.BİM", "Perakende.Migros", 0.81],
                    ["Finans.Garanti", "Enerji.Tüpraş", 0.55],
                    ["Teknoloji.Logo", "Teknoloji.Netaş", 0.69],
                    ["Telekom.Turkcell", "Teknoloji.Logo", 0.58],
                    ["Sanayi.Ereğli", "Enerji.Tüpraş", 0.63],
                    ["Havacılık.THY", "Enerji.Tüpraş", 0.57],
                    ["Finans.İşBank", "Sanayi.Koç", 0.60],
                    ["Perakende.BİM", "Finans.Akbank", 0.48],
                    ["Telekom.Turkcell", "Finans.Garanti", 0.52],
                    ["Sanayi.Şişe", "Enerji.Aygaz", 0.51],
                    ["Teknoloji.Aselsan", "Telekom.Turkcell", 0.46],
                    ["Havacılık.Pegasus", "Perakende.Migros", 0.39],
                    ["Finans.YKredi", "Perakende.BİM", 0.42],
                    ["Enerji.PetKim", "Sanayi.Şişe", 0.56],
                    ["Teknoloji.Netaş", "Telekom.Turkcell", 0.64],
                    ["Sanayi.Koç", "Sanayi.Şişe", 0.77],
                    ["Finans.Akbank", "Finans.İşBank", 0.90],
                    ["Havacılık.THY", "Finans.Garanti", 0.53],
                    ["Enerji.Aygaz", "Perakende.BİM", 0.37],
                    ["Teknoloji.Logo", "Sanayi.Koç", 0.44],
                    ["Telekom.Turkcell", "Havacılık.THY", 0.49]
                ];

                var sectorColors = {
                    "Finans": "#E8FF5A",
                    "Teknoloji": "#171717",
                    "Havacılık": "#525252",
                    "Enerji": "#737373",
                    "Sanayi": "#A3A3A3",
                    "Perakende": "#D4D4D4",
                    "Telekom": "#404040"
                };

                container.innerHTML = '';

                var svg = d3.select(container).append("svg")
                    .attr("width", size)
                    .attr("height", size)
                    .attr("viewBox", [-size/2, -size/2, size, size].join(" "))
                    .style("font-family", "Inter, sans-serif");

                // Build index map
                var idxMap = {};
                sectors.forEach(function(s, i) { idxMap[s.id] = i; });

                var n = sectors.length;
                var angleStep = (2 * Math.PI) / n;

                // Node positions on circle
                sectors.forEach(function(s, i) {
                    var angle = i * angleStep - Math.PI / 2;
                    s.x = Math.cos(angle) * outerRadius;
                    s.y = Math.sin(angle) * outerRadius;
                    s.ix = Math.cos(angle) * innerRadius;
                    s.iy = Math.sin(angle) * innerRadius;
                    s.angle = angle;
                });

                // Draw links as quadratic bezier curves through center region
                var linkGroup = svg.append("g").attr("class", "links");

                links.forEach(function(link, li) {
                    var srcIdx = idxMap[link[0]];
                    var tgtIdx = idxMap[link[1]];
                    if (srcIdx === undefined || tgtIdx === undefined) return;

                    var src = sectors[srcIdx];
                    var tgt = sectors[tgtIdx];
                    var strength = link[2];

                    // Curve through center with tension
                    var tension = 0.65;
                    var cx = (src.ix + tgt.ix) * (1 - tension) / 2;
                    var cy = (src.iy + tgt.iy) * (1 - tension) / 2;

                    var pathD = "M" + src.ix + "," + src.iy + " Q" + cx + "," + cy + " " + tgt.ix + "," + tgt.iy;

                    var sameSector = src.sector === tgt.sector;
                    var strokeColor = sameSector ? sectorColors[src.sector] : "#A3A3A3";
                    if (sameSector && src.sector === "Finans") strokeColor = "#c8d94d";

                    linkGroup.append("path")
                        .attr("d", pathD)
                        .attr("fill", "none")
                        .attr("stroke", strokeColor)
                        .attr("stroke-width", Math.max(0.5, strength * 2.5))
                        .attr("stroke-opacity", 0)
                        .attr("stroke-linecap", "round")
                        .transition()
                        .duration(800)
                        .delay(li * 25)
                        .attr("stroke-opacity", Math.max(0.15, strength * 0.5));
                });

                // Draw nodes
                var nodeGroup = svg.append("g").attr("class", "nodes");

                sectors.forEach(function(s, i) {
                    var g = nodeGroup.append("g")
                        .attr("transform", "translate(" + s.ix + "," + s.iy + ")")
                        .style("cursor", "pointer");

                    g.append("circle")
                        .attr("r", 0)
                        .attr("fill", sectorColors[s.sector] || "#999")
                        .attr("stroke", "#000")
                        .attr("stroke-width", 1.5)
                        .transition()
                        .duration(500)
                        .delay(i * 30)
                        .attr("r", 5);

                    // Label
                    var angle = s.angle;
                    var labelRadius = outerRadius + 8;
                    var lx = Math.cos(angle) * labelRadius;
                    var ly = Math.sin(angle) * labelRadius;
                    var degrees = angle * 180 / Math.PI;
                    var flip = (degrees > 90 || degrees < -90);

                    nodeGroup.append("text")
                        .attr("x", lx)
                        .attr("y", ly)
                        .attr("text-anchor", flip ? "end" : "start")
                        .attr("dominant-baseline", "middle")
                        .attr("transform", "rotate(" + (flip ? degrees + 180 : degrees) + "," + lx + "," + ly + ")")
                        .text(s.name)
                        .attr("font-size", "9px")
                        .attr("font-weight", "500")
                        .attr("fill", "#525252")
                        .attr("opacity", 0)
                        .transition()
                        .delay(600 + i * 30)
                        .duration(300)
                        .attr("opacity", 1);

                    // Hover interactions
                    g.on("mouseenter", function() {
                        d3.select(this).select("circle").attr("r", 8).attr("stroke-width", 2.5);
                        linkGroup.selectAll("path").attr("stroke-opacity", 0.05);
                        // Highlight connected links
                        links.forEach(function(link, li) {
                            if (link[0] === s.id || link[1] === s.id) {
                                linkGroup.selectAll("path").filter(function(d, idx) { return idx === li; })
                                    .attr("stroke-opacity", 0.8)
                                    .attr("stroke-width", 3)
                                    .attr("stroke", "#E8FF5A");
                            }
                        });
                    });
                    g.on("mouseleave", function() {
                        d3.select(this).select("circle").attr("r", 5).attr("stroke-width", 1.5);
                        linkGroup.selectAll("path").each(function(d, idx) {
                            if (idx < links.length) {
                                var link = links[idx];
                                var str = link[2];
                                var srcS = sectors[idxMap[link[0]]];
                                var tgtS = sectors[idxMap[link[1]]];
                                var same = srcS && tgtS && srcS.sector === tgtS.sector;
                                var col = same ? sectorColors[srcS.sector] : "#A3A3A3";
                                if (same && srcS.sector === "Finans") col = "#c8d94d";
                                d3.select(this)
                                    .attr("stroke-opacity", Math.max(0.15, str * 0.5))
                                    .attr("stroke-width", Math.max(0.5, str * 2.5))
                                    .attr("stroke", col);
                            }
                        });
                    });
                });

                // Sector legend in center
                var uniqueSectors = [];
                var seen = {};
                sectors.forEach(function(s) {
                    if (!seen[s.sector]) { seen[s.sector] = true; uniqueSectors.push(s.sector); }
                });

                uniqueSectors.forEach(function(sec, i) {
                    var ly = -uniqueSectors.length * 7 + i * 14;
                    svg.append("circle").attr("cx", -25).attr("cy", ly).attr("r", 3)
                        .attr("fill", sectorColors[sec]);
                    svg.append("text").attr("x", -18).attr("y", ly)
                        .attr("dominant-baseline", "middle")
                        .text(sec)
                        .attr("font-size", "7px")
                        .attr("fill", "#737373")
                        .attr("font-weight", "500");
                });

                // Update footer time
                var timeEl = document.getElementById('edge-chart-time');
                if (timeEl) {
                    var now = new Date();
                    timeEl.textContent = now.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
                }

                console.log('Edge bundling chart rendered successfully');
                } catch(e) {
                    console.error('Edge bundling chart error:', e);
                }
            },

            // ========== TOAST NOTIFICATION SYSTEM ==========
            showToast: function(message, type) {
                var container = document.getElementById('toast-container');
                if (!container) return;
                var colors = {
                    success: { bg: '#F0FDF4', border: '#059669', icon: '#059669', text: '#065F46' },
                    info: { bg: '#FFFDE6', border: '#171717', icon: '#171717', text: '#171717' },
                    warning: { bg: '#FFF7ED', border: '#EA580C', icon: '#EA580C', text: '#9A3412' },
                    error: { bg: '#FEF2F2', border: '#DC2626', icon: '#DC2626', text: '#991B1B' }
                };
                var c = colors[type] || colors.info;
                var icons = {
                    success: '<path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>',
                    info: '<circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/>',
                    warning: '<path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>',
                    error: '<circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>'
                };
                var toast = document.createElement('div');
                toast.className = 'toast-enter';
                toast.style.cssText = 'display:flex;align-items:center;gap:10px;padding:12px 16px;border-radius:12px;min-width:300px;max-width:400px;box-shadow:0 8px 30px rgba(0,0,0,0.12);background:' + c.bg + ';border:2px solid ' + c.border + ';';
                toast.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="' + c.icon + '" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">' + (icons[type] || icons.info) + '</svg><div style="flex:1"><p style="font-size:13px;font-weight:500;color:' + c.text + ';font-family:Inter,sans-serif;margin:0;">' + message + '</p><p style="font-size:11px;color:#737373;font-family:Inter,sans-serif;margin:2px 0 0;">' + this.utils.formatTime() + '</p></div><button onclick="this.parentElement.className=\'toast-exit\';setTimeout(function(){this.parentElement&&this.parentElement.remove()}.bind(this),300)" style="background:none;border:none;cursor:pointer;padding:2px;color:#A3A3A3;font-size:16px;line-height:1;">&times;</button>';
                container.appendChild(toast);
                setTimeout(function() {
                    if (toast.parentElement) {
                        toast.className = 'toast-exit';
                        setTimeout(function() { toast.remove(); }, 300);
                    }
                }, 4000);
            },

            initToastSystem: function() {
                var self = this;
                var aiAlerts = [
                    { msg: 'THYAO %2.3 yükseldi - Hedef fiyat güncellendi', type: 'success' },
                    { msg: 'Yeni AI sinyal: GARAN alım fırsatı tespit edildi', type: 'info' },
                    { msg: 'BIST 100 direnç seviyesine yaklaşıyor', type: 'warning' },
                    { msg: 'Portföy risk skoru güncellendi: Orta → Düşük', type: 'success' },
                    { msg: 'ASELS teknik analiz: Güçlü alım sinyali', type: 'info' },
                    { msg: 'USD/TRY volatilite uyarısı', type: 'warning' },
                    { msg: 'Trend Takipçi: EREGL pozisyon kapattı (+%4.2)', type: 'success' },
                    { msg: 'Momentum Agent: SISE alım emri verdi', type: 'info' },
                    { msg: 'Günlük kâr hedefi %85 tamamlandı', type: 'success' },
                    { msg: 'Sektör rotasyonu tespit edildi: Finans → Teknoloji', type: 'info' }
                ];
                var idx = 0;
                setTimeout(function showNext() {
                    self.showToast(aiAlerts[idx].msg, aiAlerts[idx].type);
                    self.addNotification(aiAlerts[idx].msg);
                    idx = (idx + 1) % aiAlerts.length;
                    setTimeout(showNext, 12000 + Math.random() * 8000);
                }, 5000);
            },

            // ========== PORTFOLIO PAGE FILTERS ==========
            initPortfolioFilters: function() {
                var self = this;
                document.querySelectorAll('.pf-filter-btn').forEach(function(btn) {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.pf-filter-btn').forEach(function(b) {
                            b.style.backgroundColor = '';
                            b.style.border = '';
                            b.classList.add('text-neutral-500');
                        });
                        btn.style.backgroundColor = '#E8FF5A';
                        btn.style.border = '2px solid #000000';
                        btn.classList.remove('text-neutral-500');
                        var filter = btn.dataset.filter;
                        document.querySelectorAll('.holding-row').forEach(function(row) {
                            if (filter === 'all' || row.dataset.type === filter) {
                                row.style.display = 'flex';
                            } else {
                                row.style.display = 'none';
                            }
                        });
                    });
                });
            },

            // ========== HISTORY PAGE FILTERS ==========
            initHistoryFilters: function() {
                var self = this;
                document.querySelectorAll('.hist-filter-btn').forEach(function(btn) {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.hist-filter-btn').forEach(function(b) {
                            b.style.backgroundColor = '';
                            b.classList.add('text-neutral-500');
                        });
                        btn.style.backgroundColor = '#E8FF5A';
                        btn.classList.remove('text-neutral-500');
                        var filter = btn.dataset.filter;
                        document.querySelectorAll('.hist-row').forEach(function(row) {
                            if (filter === 'all' || row.dataset.type === filter) {
                                row.style.display = 'flex';
                            } else {
                                row.style.display = 'none';
                            }
                        });
                    });
                });
                var dateFilter = document.getElementById('history-date-filter');
                if (dateFilter) {
                    dateFilter.addEventListener('change', function() {
                        self.showToast('Tarih filtresi güncellendi: ' + dateFilter.options[dateFilter.selectedIndex].text, 'info');
                    });
                }
            },

            // ========== FUNDS PAGE BUTTONS ==========
            initFundButtons: function() {
                var self = this;
                document.querySelectorAll('.fund-invest-btn').forEach(function(btn) {
                    btn.addEventListener('click', function() {
                        var fund = btn.dataset.fund;
                        var price = parseFloat(btn.dataset.price);
                        self.openTradeModal(fund, price);
                    });
                });
            },

            // ========== FOOTER LINKS ==========
            initFooterLinks: function() {
                var self = this;
                document.querySelectorAll('.footer-link').forEach(function(link) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        var text = link.textContent.trim();
                        self.showToast(text + ' sayfası yakında aktif olacak', 'info');
                    });
                });
            },

            // ========== HOLDING CLICKS ==========
            initHoldingClicks: function() {
                var self = this;
                document.querySelectorAll('.holding-row').forEach(function(row) {
                    row.addEventListener('click', function() {
                        var symbol = row.dataset.symbol;
                        var stock = self.state.watchlist.find(function(s) { return s.symbol === symbol; });
                        if (stock) {
                            self.openTradeModal(symbol, stock.price);
                        } else {
                            self.openTradeModal(symbol, 100);
                        }
                    });
                });
            },

            initUserMenu: function() {
                var self = this;
                var avatar = document.getElementById('user-avatar');
                if (!avatar) return;
                avatar.addEventListener('click', function() {
                    var existing = document.getElementById('user-menu-dropdown');
                    if (existing) { existing.remove(); return; }
                    var menu = document.createElement('div');
                    menu.id = 'user-menu-dropdown';
                    menu.className = 'absolute top-10 right-0 w-56 bg-white rounded-xl shadow-xl z-50';
                    menu.style.cssText = 'border: 2px solid #000000;';
                    menu.innerHTML = '<div class="px-4 py-3" style="border-bottom:2px solid #000000;"><p class="text-sm font-semibold text-neutral-900 font-sans">Ahmet Kaya</p><p class="text-xs text-neutral-500 font-sans">ahmet.kaya@nurol.com</p></div>'
                        + '<div class="py-1">'
                        + '<a href="#" class="user-menu-item block px-4 py-2.5 text-sm text-neutral-700 hover:bg-neutral-50 font-sans" data-action="profile">👤 Profilim</a>'
                        + '<a href="#" class="user-menu-item block px-4 py-2.5 text-sm text-neutral-700 hover:bg-neutral-50 font-sans" data-action="settings">⚙️ Ayarlar</a>'
                        + '<a href="#" class="user-menu-item block px-4 py-2.5 text-sm text-neutral-700 hover:bg-neutral-50 font-sans" data-action="api">🔑 API Anahtarları</a>'
                        + '<a href="#" class="user-menu-item block px-4 py-2.5 text-sm text-neutral-700 hover:bg-neutral-50 font-sans" data-action="reports">📊 Raporlar</a>'
                        + '</div>'
                        + '<div style="border-top:2px solid #000000;">'
                        + '<a href="#" class="user-menu-item block px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 font-sans" data-action="logout">🚪 Çıkış Yap</a>'
                        + '</div>';
                    avatar.parentElement.appendChild(menu);
                    menu.querySelectorAll('.user-menu-item').forEach(function(item) {
                        item.addEventListener('click', function(e) {
                            e.preventDefault();
                            var action = item.dataset.action;
                            var msgs = { profile: 'Profil sayfası yakında aktif olacak', settings: 'Ayarlar sayfası yakında aktif olacak', api: 'API yönetimi yakında aktif olacak', reports: 'Rapor oluşturuluyor...', logout: 'Oturum kapatılıyor...' };
                            self.showToast(msgs[action] || 'Yakında aktif olacak', action === 'logout' ? 'warning' : 'info');
                            menu.remove();
                        });
                    });
                    setTimeout(function() {
                        document.addEventListener('click', function closeMenu(e) {
                            if (!menu.contains(e.target) && e.target !== avatar) {
                                menu.remove();
                                document.removeEventListener('click', closeMenu);
                            }
                        });
                    }, 10);
                });
            }
        };

        // Initialize on DOM ready
        document.addEventListener('DOMContentLoaded', () => NurolApp.init());
    </script>

</body></html>